class calendar_{constructor(){this.cal=null,this.card_cal=null,this.note_cal=null,this.cal_org_all=null,this.cal_org_mgt=null,this.cal_is_first_load=!0,this.event_offset_x=null,this.event_offset_y=null,this.enum_type_access={own:1,use:2,view:3},this.is_navigation_stop=!1}get_start_time(e,t){if(1==e)return null==$("#start_date",t).data("datepicker")?moment($("#start_date",t).val()):moment($("#start_date",t).data("datepicker").selectedDates[0]);if(null==$("#start_date",t).data("datepicker"))return moment($("#start_date",t).val()+" "+$("#start_time",t).val());{let e=moment($("#start_time",t).timepicker().getTime());return moment($("#start_date",t).data("datepicker").selectedDates[0]).startOf("day").add(e.get("hour"),"h").add(e.get("minute"),"m")}}get_end_time(e,t){if(1==e)return null==$("#end_date",t).data("datepicker")?moment($("#end_date",t).val()):moment($("#end_date",t).data("datepicker").selectedDates[0]);if(null==$("#end_date",t).data("datepicker"))return moment($("#end_date",t).val()+" "+$("#end_time",t).val());{let e=moment($("#end_time",t).timepicker().getTime());return moment($("#end_date",t).data("datepicker").selectedDates[0]).startOf("day").add(e.get("hour"),"h").add(e.get("minute"),"m")}}set_events(e){let t=new Array,a=e.card_seq.length;for(let n=0;n<a;++n){let a,l=e.is_all_day[n],c=e.is_repeat[n];switch(e.depth[n]){case 0:a="#aaecff";break;case 1:a="#fdd996";break;default:a="#c7c7c7"}let d={id:e.card_seq[n],groupid:e.card_seq[n],title:e.title[n],allDay:l,start:moment.unix(e.start_ts[n]).format(),end:moment.unix(e.end_ts[n]).format(),status:e.status[n],is_hidden:e.is_hidden[n],is_deleted:!!e.is_deleted[n],is_todo:e.is_todo[n],is_repeat:c,editable:e.editable[n],owner_account_seq:e.owner_account_seq[n],type_group:1,depth:e.depth[n],color:a};0!=e.end_ts[n]&&1==l&&0==c&&(d.end=moment.unix(e.end_ts[n]).add(1,"d").format()),t.push(d)}return t}set_note_events(e){let t=new Array,a=e.note_seq.length;for(let n=0;n<a;++n){let a,l=e.is_all_day[n],c=e.is_repeat[n];switch(e.depth[n]){case 0:a="#aaecff";break;case 1:a="#fdd996";break;default:a="#c7c7c7"}let d={id:e.note_seq[n],groupid:e.note_seq[n],title:e.title[n],allDay:l,start:moment.unix(e.start_ts[n]).format(),end:moment.unix(e.end_ts[n]).format(),status:e.status[n],is_deleted:!!e.is_deleted[n],is_repeat:c,depth:e.depth[n],color:a};0!=e.end_ts[n]&&1==l&&0==c&&(d.end=moment.unix(e.end_ts[n]).add(1,"d").format()),t.push(d)}return t}set_org_events(e){let t=new Array,a=e.card_seq.length;for(let n=0;n<a;++n){let a=e.is_all_day[n],l=e.is_repeat[n],c={id:e.card_seq[n],groupid:e.card_seq[n],title:e.title[n],allDay:a,start:moment.unix(e.start_ts[n]).format(),end:moment.unix(e.end_ts[n]).format(),status:e.status[n],is_hidden:e.is_hidden[n],is_deleted:!!e.is_deleted[n],is_todo:e.is_todo[n],is_repeat:l,owner_account_seq:e.owner_account_seq[n],color:"lightgray"};0!=e.end_ts[n]&&1==a&&0==l&&(c.end=moment.unix(e.end_ts[n]).add(1,"d").format()),t.push(c)}return t}set_main_cal_events(e){let t=new Array,a=e.calendar_event_seq.length;for(let n=0;n<a;++n){let a=e.list_schedule.is_all_day[n],l=e.list_schedule.is_repeat[n],c=$(`#tabs-calendar .cal_check_btn[data-cal_seq="${e.calendar_seq[n]}"]`).css("color"),d={id:e.calendar_event_seq[n],event_seq:e.calendar_event_seq[n],title:e.title[n],cal_seq:e.calendar_seq[n],create_account_seq:e.create_account_seq[n],allDay:a,start:moment.unix(e.list_schedule.start_ts[n]).format(),end:moment.unix(e.list_schedule.end_ts[n]).format(),is_file:e.is_file[n],is_repeat:l,cal_color:c,color:c,textColor:1==tinycolor(c).isDark()&&.3<tinycolor(c).getAlpha()?"#fff":"#000"};0!=e.list_schedule.end_ts[n]&&1==a&&0==l&&(d.end=moment.unix(e.list_schedule.end_ts[n]).add(1,"d").format()),t.push(d)}return t}get_cal_check_list(){let e=JSON.parse(localStorage.getItem("cal_check_list_"+space_seq+"_"+account_list.get_user_account().account_seq));return null==e?(this.set_cal_check_list(),JSON.parse(localStorage.getItem("cal_check_list_"+space_seq+"_"+account_list.get_user_account().account_seq))):e}set_cal_check_list(){let e=[],t="cal_check_list_"+space_seq+"_"+account_list.get_user_account().account_seq;$("#tabs-calendar #calendar_list .checked").each((function(){e.push($(this).data("cal_seq"))})),localStorage.setItem(t,JSON.stringify(e))}}function get_schedule_data(e){let t={is_repeat:(!1,!1),is_all_day:!0,start:null,end:null,r_rule:"",duration:0};if(t.is_all_day=!$("#date_input_modal #is_all_day").hasClass("uncheck"),1==t.is_all_day)null==$("#start_date",e).data("datepicker")?(t.start=moment($("#start_date",e).val()),t.end=moment($("#end_date",e).val())):(t.start=moment($("#start_date",e).data("datepicker").selectedDates[0]),t.end=moment($("#end_date",e).data("datepicker").selectedDates[0]));else if(null==$("#start_date").data("datepicker"))t.start=moment($("#start_date",e).val()+" "+$("#start_time",e).val()),t.end=moment($("#end_date",e).val()+" "+$("#end_time",e).val());else{let a=moment($("#start_time",e).timepicker().getTime()),n=moment($("#end_time",e).timepicker().getTime());t.start=moment($("#start_date",e).data("datepicker").selectedDates[0]).startOf("day").add(a.get("hour"),"h").add(a.get("minute"),"m"),t.end=moment($("#end_date",e).data("datepicker").selectedDates[0]).startOf("day").add(n.get("hour"),"h").add(n.get("minute"),"m")}return t.start=t.start.unix(),t.end=t.end.unix(),t}$((function(){calendar.cal=new FullCalendar.Calendar($("#tabs-calendar #calendar_v")[0],{headerToolbar:{left:"",center:"",right:""},views:{timeGridDay:{columnHeaderFormat:"L"}},initialView:"dayGridMonth",contentHeight:"calc(100vh - 44px)",initialDate:new Date,eventColor:"green",editable:!0,droppable:!0,dayMaxEventRows:!0,eventOrder:"backgroundColor",locale:i18next.languages[0],selectable:!0,eventTextColor:"#000",eventDragStart:function(){calendar.is_navigation_stop=!0},eventDrop:function(e){let t;t=1==e.event.allDay&&0==e.event.extendedProps.is_repeat?null==e.event.end?moment(e.event.start).unix():moment(e.event.end).add(-1,"d").unix():moment(null==e.event.end?e.event.start:e.event.end).unix(),set_event_update(e.event.id,null,null,moment(e.event.start).unix(),t,e.event.allDay)},eventResizeStart:function(){calendar.is_navigation_stop=!0},eventResize:function(e){let t;t=1==e.event.allDay&&0==e.event.extendedProps.is_repeat?null==e.event.end?moment(e.event.start).unix():moment(e.event.end).add(-1,"d").unix():moment(null==e.event.end?e.event.start:e.event.end).unix(),set_event_update(e.event.id,null,null,moment(e.event.start).unix(),t,e.event.allDay)},select:function(e){calendar.is_navigation_stop=!0;let t=1==e.allDay?moment(e.end).add(-1,"d").format():e.end;v_date_input($("#event_create_modal"),e.start,t,e.allDay,!1,!0),$("#event_create_modal #event_file_zone >").remove(),$("#event_create_modal .event_title_input").val(""),$("#event_create_modal #event_note_input").val("");let a=calendar.get_cal_check_list();0!=a.length?$("#event_create_modal select.cal_select")[0].sumo.selectItem(a[0].toString()):$("#event_create_modal select.cal_select")[0].sumo.selectItem(0),$("#event_create_modal").modal()},eventClick:function(e){get_pop_event_info(e)}}),event_file_dropzone($("#event_create_modal .modal-content"),"#event_create_modal #event_file_add_btn","#event_create_modal #event_file_zone"),event_file_dropzone($("#event_edit_modal .modal-content"),"#event_edit_modal #event_edit_file_add_btn","#event_edit_modal #event_file_zone"),calendar.card_cal=new FullCalendar.Calendar($("#tabs-tree #calendar_v")[0],{headerToolbar:{left:"prev,next",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},titleFormat:{year:"2-digit",month:"2-digit"},views:{timeGridDay:{columnHeaderFormat:"L"}},initialView:"dayGridMonth",contentHeight:800,initialDate:new Date,eventColor:"green",editable:!0,droppable:!0,dayMaxEventRows:!0,eventOrder:"backgroundColor",locale:i18next.languages[0],selectable:!0,eventTextColor:"#000",eventDrop:function(e){let t;$(".popover.fade.top").remove(),t=1==e.event.allDay&&0==e.event.extendedProps.is_repeat?null==e.event.end?moment(e.event.start).unix():moment(e.event.end).add(-1,"d").unix():moment(null==e.event.end?e.event.start:e.event.end).add(1,"h").unix(),card_set_schedule(e.event.id,!1,e.event.allDay,moment(e.event.start).unix(),t,"",0)},eventResize:function(e){let t;$(".popover.fade.top").remove(),t=1==e.event.allDay&&0==e.event.extendedProps.is_repeat?null==e.event.end?moment(e.event.start).unix():moment(e.event.end).add(-1,"d").unix():moment(null==e.event.end?e.event.start:e.event.end).unix(),card_set_schedule(e.event.id,!1,e.event.allDay,moment(e.event.start).unix(),t,"",0)},select:function(e){let t=1==e.allDay?moment(e.end).add(-1,"d").format():e.end;$("#card_create_schedule_modal").data("tree_type",tree_data.enum_tree_type.card),v_date_input($("#card_create_schedule_modal"),e.start,t,e.allDay,!1,!0),$("#card_create_schedule_modal").modal()},eventDidMount:function(e){$(e.el).prepend(`<span class="cal_card_info pull-left">\n${select_state_icon(e.event.extendedProps.status,"fa-md")}\n${select_state_sytle(e.event.extendedProps.is_hidden,e.event.extendedProps.is_deleted)}\n</span>`),$(e.el).webuiPopover({title:`<div class="over_wrapper text-center">${e.event.title}</div>`,content:`<div>\n<div><strong></strong>\n<img class="img-circle user_photo"\nsrc="${account_list.get_account(e.event.extendedProps.owner_account_seq).photo_url}">\n${account_list.get_account(e.event.extendedProps.owner_account_seq).name}\n<span>${select_state_icon(e.event.extendedProps.status)}</span>\n</div>\n<div><span class="label label-primary label-lg">${lll_time(moment(e.event.start).unix())}</span></div>\n<div><strong> ~ </strong><span class="label label-danger label-lg">${lll_time(moment(e.event.end).unix())}</span></div>\n</div>`,delay:{show:"800",hide:"50"},trigger:"hover",placement:"top",html:!0,container:"body"}),$(".cal_card_info",e.el).localize()},eventClick:function(e){card_view_handle(e.event.id,init.info_time_type_enum.card,!0)}}),calendar.note_cal=new FullCalendar.Calendar($("#tabs-note #calendar_v")[0],{headerToolbar:{left:"prev,next",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},titleFormat:{year:"2-digit",month:"2-digit"},views:{timeGridDay:{columnHeaderFormat:"L"}},initialView:"dayGridMonth",contentHeight:800,initialDate:new Date,eventColor:"green",editable:!0,droppable:!0,dayMaxEventRows:!0,eventOrder:"backgroundColor",locale:i18next.languages[0],selectable:!0,eventDrop:function(e){let t;$(".popover.fade.top").remove(),t=1==e.event.allDay&&0==e.event.extendedProps.is_repeat?moment(e.event.end?e.event.end:0).add(-1,"d").unix():moment(e.event.end?e.event.end:0).unix(),note_set_schedule(e.event.id,!1,e.event.allDay,moment(e.event.start).unix(),t,"",0)},eventResize:function(e){let t;$(".popover.fade.top").remove(),t=1==e.event.allDay&&0==e.event.extendedProps.is_repeat?moment(e.event.end?e.event.end:0).add(-1,"d").unix():moment(e.event.end?e.event.end:0).unix(),note_set_schedule(e.event.id,!1,e.event.allDay,moment(e.event.start).unix(),t,"",0)},select:function(e){let t=1==e.allDay?moment(e.end).add(-1,"d").format():e.end;$("#card_create_schedule_modal").data("tree_type",tree_data.enum_tree_type.note),v_date_input($("#card_create_schedule_modal"),e.start,t,e.allDay,!1,!0),$("#card_create_schedule_modal").modal()},eventDidMount:function(e){$(".fc-event-title",e.el).prepend(`<span class="cal_card_info">\n${select_state_icon(e.event.extendedProps.status,"fa-md")}\n${select_state_sytle(!1,e.event.extendedProps.is_deleted)}\n</span>`),$(e.el).webuiPopover({title:`<div class="over_wrapper text-center">${e.event.title}</div>`,content:`<div>\n<div><strong></strong>\n<span>${select_state_icon(e.event.extendedProps.status)}</span>\n</div>\n<div><span class="label label-primary label-lg">${lll_time(moment(e.event.start).unix())}</span></div>\n<div><strong> ~ </strong><span class="label label-danger label-lg">${lll_time(moment(e.event.end).unix())}</span></div>\n</div>`,delay:{show:"800",hide:"50"},trigger:"hover",placement:"top",html:!0,container:"body"}),$(".cal_card_info",e.el).localize()},eventClick:function(e){card_view_handle(e.event.id,null,!0,tree_data.enum_tree_type.note)}}),calendar.cal_org_all=new FullCalendar.Calendar($("#org_all_schedule #calendar_v")[0],{headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},titleFormat:{year:"2-digit",month:"2-digit"},views:{timeGridDay:{columnHeaderFormat:"L"}},contentHeight:800,initialView:"dayGridMonth",initialDate:new Date,eventColor:"green",editable:!1,droppable:!1,dayMaxEventRows:!0,eventOrder:"backgroundColor",locale:i18next.languages[0],eventDidMount:function(e){$(".fc-content",e.el).prepend(`<span class="cal_card_info photo_sm">\n<img class="img-circle user_photo" src="${account_list.get_account(e.event.extendedProps.owner_account_seq).photo_url}">\n${select_state_icon(e.event.extendedProps.status,"fa-md")}\n${select_state_sytle(e.event.extendedProps.is_hidden,e.event.extendedProps.is_deleted)}\n</span>`),$(e.el).webuiPopover({title:`<div class="over_wrapper text-center">${e.event.title}</div>`,content:`<div>\n<div><strong></strong>\n<img class="img-circle user_photo"\nsrc="${account_list.get_account(e.event.extendedProps.owner_account_seq).photo_url}">\n${account_list.get_account(e.event.extendedProps.owner_account_seq).name}\n<span>${select_state_icon(e.event.extendedProps.status)}</span>\n</div>\n<div><span class="label label-primary label-lg">${lll_time(moment(e.event.start).unix())}</span></div>\n<div><strong> ~ </strong><span class="label label-danger label-lg">${lll_time(moment(e.event.end).unix())}</span></div>\n</div>`,delay:{show:"800",hide:"50"},trigger:"hover",placement:"top",html:!0,container:"body"}),$(".cal_card_info",e.el).localize()},eventClick:function(e){card_view_handle(e.event.id,init.info_time_type_enum.card,!1)}}),calendar.cal_org_mgt=new FullCalendar.Calendar($("#org_mgt_schedule #calendar_v")[0],{headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},titleFormat:{year:"2-digit",month:"2-digit"},views:{timeGridDay:{columnHeaderFormat:"L"}},contentHeight:800,initialView:"dayGridMonth",initialDate:new Date,eventColor:"green",editable:!1,droppable:!1,dayMaxEventRows:!0,eventOrder:"backgroundColor",locale:i18next.languages[0],eventDidMount:function(e){$(".fc-content",e.el).prepend(`<span class="cal_card_info photo_sm">\n<img class="img-circle user_photo" src="${account_list.get_account(e.event.extendedProps.owner_account_seq).photo_url}">\n${select_state_icon(e.event.extendedProps.status,"fa-md")}\n${select_state_sytle(e.event.extendedProps.is_hidden,e.event.extendedProps.is_deleted)}\n</span>`),$(e.el).webuiPopover({title:`<div class="over_wrapper text-center">${e.event.title}</div>`,content:`<div>\n<div><strong></strong>\n<img class="img-circle user_photo"\nsrc="${account_list.get_account(e.event.extendedProps.owner_account_seq).photo_url}">\n${account_list.get_account(e.event.extendedProps.owner_account_seq).name}\n<span>${select_state_icon(e.event.extendedProps.status)}</span>\n</div>\n<div><span class="label label-primary label-lg">${lll_time(moment(e.event.start).unix())}</span></div>\n<div><strong> ~ </strong><span class="label label-danger label-lg">${lll_time(moment(e.event.end).unix())}</span></div>\n</div>`,delay:{show:"800",hide:"50"},trigger:"hover",placement:"top",html:!0,container:"body"}),$(".cal_card_info",e.el).localize()},eventClick:function(e){card_view_handle(e.event.id,init.info_time_type_enum.card,!1)}})}));let calendar=new calendar_;$(document).on("click","#tabs-tree #calendar_hidden",(function(){card_get_schedule_json()})),$(document).on("click","#tabs-tree #calendar_depth_btn",(function(){card_get_schedule_json()})),$(document).on("click","#tabs-note #calendar_hidden",(function(){note_get_schedule(note.note_seq)})),$(document).on("click","#tabs-note #calendar_depth_btn",(function(){note_get_schedule(note.note_seq)})),$(document).on("click","#card_view_modal #cost_view_btn",(function(){get_cost_view(card_detail.temp_card_seq),$("#cost_view_modal").modal()})),$(document).on("click","#card_create_schedule_modal #create_card_btn",(function(){let e=$("#card_create_schedule_modal .create_card_input").val(),t=!$("#card_create_schedule_modal #is_all_day").hasClass("uncheck"),a=calendar.get_start_time(t,$("#card_create_schedule_modal")),n=calendar.get_end_time(t,$("#card_create_schedule_modal"));if(a-n<=0){let l=card_detail.card_seq;$("#card_view_modal").hasClass("in")&&(l=card_detail.temp_card_seq),card_set_create($("#card_create_schedule_modal .create_card_input"),l,e,false,t,a.unix(),n.unix(),"",0,!0)}else console.log("faill");$("#card_create_schedule_modal .create_card_input").focus()})),$(document).on("click","#card_create_schedule_modal #create_card_close_btn",(function(){let e=$("#card_create_schedule_modal .create_card_input").val(),t=!$("#card_create_schedule_modal #is_all_day").hasClass("uncheck"),a=calendar.get_start_time(t,$("#card_create_schedule_modal")),n=calendar.get_end_time(t,$("#card_create_schedule_modal"));if(a-n<=0){let l=card_detail.card_seq;$("#card_view_modal").hasClass("in")&&(l=card_detail.temp_card_seq),card_set_create($("#card_create_schedule_modal .create_card_input"),l,e,false,t,a.unix(),n.unix(),"",0,!0)}else console.log("faill");$("#card_create_schedule_modal").modal("hide")})),$(document).on("click",".mobile_app #tabs-calendar #cal_menu_btn",(function(){1==init.is_web?$("#main_menu").toggleClass("main_menu_open"):0===init.calendar_split.getSizes()[0]?(v_mobile_cal_layout(!1,!0),init.calendar_split.setSizes([80,20])):($("#menu_overlay").toggleClass("hidden"),$("#main_menu").toggleClass("fixed").toggleClass("main_menu_open").toggleClass("hidden"))})),$(document).on("click",".mobile_app #tabs-calendar #m_calendar_veiw_btn",(function(){v_mobile_cal_layout(!0,!1),init.calendar_split.setSizes([0,100]),calendar.cal.updateSize()})),$(document).on("click","#calendar_split_left .calendar_switch_btn",(function(){$("#main_calendar").toggleClass("dis_none"),$("#main_calendar_set").toggleClass("dis_none"),set_calendar_set_split(),calendar.cal.updateSize()})),$(document).on("click","#main_calendar_set .calendar_switch_btn",(function(){0==init.is_web?0==init.calendar_set_split.getSizes()[0]?split_collapse(init.calendar_set_split,1):($("#main_calendar").toggleClass("dis_none"),$("#main_calendar_set").toggleClass("dis_none")):($("#main_calendar").toggleClass("dis_none"),$("#main_calendar_set").toggleClass("dis_none"),set_calendar_set_split(),calendar.cal.updateSize())})),$(document).on("click","#tabs-calendar #calendar_create_modal_btn",(function(){$("#calendar_create_modal").modal()})),$(document).on("shown.bs.modal","#calendar_create_modal",(function(){$("#calendar_create_modal #create_cal_input").focus()})),$(document).on("click","#calendar_create_modal #calendar_create_btn",(function(){set_calendar_create($("#calendar_create_modal #create_cal_input").val())})),$(document).on("keydown","#calendar_create_modal #create_cal_input",(function(e){13==e.keyCode&&$("#calendar_create_modal #calendar_create_btn").trigger("click")})),$(document).on("click","#tabs-calendar #calendar_order_modal_btn",(function(){get_sort_calendar_list(),$("#calendar_order_modal").modal()})),$(document).on("click",".cal_set_drop .cal_set_btn:not([disabled])",(function(e){e.preventDefault(),e.stopPropagation();let t=$(this).closest(".cal_set_drop"),a=$(t).data("cal_seq");get_calendar_info(a)})),$(document).on("click",".cal_set_drop .cal_share_btn:not([disabled])",(function(){let e=$(this).closest(".cal_set_drop"),t=$(e).data("cal_seq");get_calendar_member(t)})),$(document).on("click",".cal_set_drop .cal_lock_btn",(function(){let e=$(this).closest(".cal_set_drop"),t=$(e).data("cal_seq"),a=!$(e).data("is_lock");set_calendar_update((()=>WebuiPopovers.hideAll()),t,null,null,a)})),$(document).on("click",".cal_set_drop .cal_deadline_btn:not([disabled])",(function(){let e=$(this).closest(".cal_set_drop"),t=$(e).data("cal_seq"),a=$(e).data("is_deadline"),n=moment.unix($(e).data("limit_start_date")),l=moment.unix($(e).data("limit_end_date"));0==a&&(n=moment(),l=moment()),v_date_input($("#calendar_deadline_modal"),n,l,!0,!1,!0),v_deadline_input($("#calendar_deadline_modal"),a),$("#calendar_deadline_modal").data("cal_seq",t),$("#calendar_deadline_modal").modal()})),$(document).on("click",".cal_set_drop .cal_leave_btn",(function(){let e=$(this).closest(".cal_set_drop");set_calendar_member_leave($(e).data("cal_seq"))})),$(document).on("click",".cal_set_drop .cal_remove_btn:not([disabled])",(function(){let e=$(this).closest(".cal_set_drop");del_calendar_remove($(e).data("cal_seq"))})),$(document).on("click","#calendar_setting_modal #cal_lock_btn",(function(){$(this).data("is_lock",!$(this).data("is_lock")),1==$(this).data("is_lock")?$(this).attr("data-i18n","calendar:cal set.unlock"):$(this).attr("data-i18n","calendar:cal set.lock"),$(this).toggleClass("uncheck"),$(this).localize()})),$(document).on("click","#calendar_setting_modal #is_deadline_btn",(function(){$(this).data("is_deadline",!$(this).data("is_deadline")),v_deadline_input($("#calendar_setting_modal"),$(this).data("is_deadline"))})),$(document).on("click","#calendar_setting_modal #cal_update_btn",(function(){let e=$(this).data("cal_seq"),t=$("#calendar_setting_modal .cal_title_input").val(),a=$("#calendar_setting_modal #cal_note_input").val(),n=Boolean($("#calendar_setting_modal #cal_lock_btn").data("is_lock")),l=Boolean($("#calendar_setting_modal #is_deadline_btn").data("is_deadline")),c=calendar.get_start_time(!0,$("#calendar_setting_modal")),d=calendar.get_end_time(!0,$("#calendar_setting_modal"));set_calendar_update((()=>$("#calendar_setting_modal").modal("hide")),e,t,a,n,null,l,c.unix(),d.unix())})),$(document).on("click","#multi_select_modal #cal_account_save_btn",(function(){let e=new Array;$("#multi_select_list >").each((function(t,a){e.push($(a).data("account_seq"))}));let t=new Array;$("#calendar_share_modal .list-group > .list-group-item").each((function(e,a){t.push($(a).data("account_seq"))}));let a=e.filter((e=>!t.includes(e))),n=t.filter((t=>!e.includes(t))),l=$("#calendar_share_modal .list-group");v_cal_share_add_account(l,a),v_cal_share_del_account(l,n),$("#multi_select_modal").modal("hide")})),$(document).on("click","#cal_del_share_li",(function(){$(this).closest(".list-group-item").remove()})),$(document).on("click","#calendar_share_modal #cal_update_btn",(function(){let e=new Array;$("#calendar_share_modal .list-group > .list-group-item").each((function(t,a){e.push($(a).data("account_seq"))}));let t=new Array;$("#calendar_share_modal .cal_share_type_view ").each((function(e,a){t.push($(a).val())})),set_calendar_update((()=>{$("#calendar_share_modal").modal("hide")}),$("#calendar_share_modal").data("cal_seq"),null,null,null,null,null,null,null,e,t)})),$(document).on("click","#calendar_share_modal #account_add_btn",(function(){let e=new Array;$("#calendar_share_modal .list-group > .list-group-item").each((function(t,a){e.push($(a).data("account_seq"))})),$("#multi_select_modal #contents_title_area h3").remove(),$("#multi_select_modal #contents_title_area").append('<h3 class="over_wrapper text-center" data-i18n="calendar:cal set.manage account"></h3>'),$("#multi_select_modal .modal-footer >").remove(),$("#multi_select_modal .modal-footer").append('<span id="cal_account_save_btn" class="pull-right btn btn-primary"\ndata-i18n="calendar:cal set.apply"></span>'),v_account_select_tree($("#multi_select_modal #multi_select_list"),$("#multi_select_modal #multi_select_tree"),e),$("#multi_select_modal").localize(),$("#multi_select_modal").modal()})),$(document).on("click","#calendar_deadline_modal #is_deadline_btn",(function(){v_deadline_input($("#calendar_deadline_modal"),$(this).hasClass("uncheck"))})),$(document).on("click","#calendar_deadline_modal #set_deadline_btn",(function(){let e=$("#calendar_deadline_modal").data("cal_seq"),t=!$("#calendar_deadline_modal #is_deadline_btn").hasClass("uncheck"),a=!$("#calendar_deadline_modal #is_all_day").hasClass("uncheck"),n=calendar.get_start_time(a,$("#calendar_deadline_modal")),l=calendar.get_end_time(a,$("#calendar_deadline_modal"));set_calendar_update((()=>$("#calendar_deadline_modal").modal("hide")),e,null,null,null,null,t,n.unix(),l.unix())})),$(document).on("click","#tabs-calendar #calendar_list .cal_check_btn",(function(e){e.preventDefault(),e.stopPropagation(),$(this).toggleClass("checked"),$(" i",this).toggleClass("far fa-square"),$(" i",this).toggleClass("fas fa-check-square"),calendar.set_cal_check_list(),get_event_list()})),$(document).on("click","#tabs-calendar #cal_prev",(function(){calendar.cal.prev(),v_cal_nav_title($("#tabs-calendar #cal_nav_title"),calendar.cal),get_event_list(),$("#calendar #calendar_v .fc-view-harness").css({left:-20,opacity:.5}),$("#calendar #calendar_v .fc-view-harness").animate({left:"0px",opacity:1},200)})),$(document).on("click","#tabs-calendar #cal_next",(function(){calendar.cal.next(),v_cal_nav_title($("#tabs-calendar #cal_nav_title"),calendar.cal),get_event_list(),$("#calendar #calendar_v .fc-view-harness").css({left:20,opacity:.5}),$("#calendar #calendar_v .fc-view-harness").animate({left:"0px",opacity:1},200)})),$(document).on("click","#tabs-calendar #cal_today",(function(){calendar.cal.today(),v_cal_nav_title($("#tabs-calendar #cal_nav_title"),calendar.cal),get_event_list()})),$(document).on("mousewheel","#calendar_split_right .fc-dayGridMonth-view",$.debounce(100,(function(e){e.originalEvent.wheelDelta<0?$("#tabs-calendar #cal_next").trigger("click"):$("#tabs-calendar #cal_prev").trigger("click")}))),$("#tabs-calendar select.cal_select_view").on("sumo:closing",(function(){calendar.cal.changeView($(this).val()),v_cal_nav_title($("#tabs-calendar #cal_nav_title"),calendar.cal),get_event_list()})),$(document).on("click","#event_create_modal #create_event_btn",(function(){let e=!$("#event_create_modal #is_all_day").hasClass("uncheck"),t=moment(calendar.get_start_time(e,$("#event_create_modal"))).unix(),a=moment(calendar.get_end_time(e,$("#event_create_modal"))).unix(),n=[];$("#event_create_modal #event_file_zone > div").each((function(e,t){n.push($(t).data("file_seq"))})),set_event_create($("#event_create_modal select.cal_select").val(),$("#event_create_modal .event_title_input").val(),$("#event_create_modal #event_note_input").val(),n,e,t,a)})),$(document).on("click",".event_pop_head #event_edit_btn",(function(){get_edit_event_info($(this).closest(".event_pop_head").data("event_seq"),$(".event_pop_head").data("cal_seq"))})),$(document).on("click","#event_edit_modal #edit_event_btn",(function(){let e=!$("#event_edit_modal #is_all_day").hasClass("uncheck"),t=moment(calendar.get_start_time(e,$("#event_edit_modal"))).unix(),a=moment(calendar.get_end_time(e,$("#event_edit_modal"))).unix(),n=[];$("#event_edit_modal #event_file_zone >:not(.upload_zone)").each((function(e,t){n.push($(t).data("file_seq"))})),set_event_update($(this).data("event_seq"),$("#event_edit_modal .event_title_input").val(),$("#event_edit_modal #event_note_input").val(),t,a,e,n,$("#event_edit_modal select.cal_select").val()),$("#event_edit_modal").modal("hide")})),$(document).on("click",".event_pop_head #event_del_btn",(function(){del_event_remove([$(this).closest(".event_pop_head").data("event_seq")])})),$(document).on("click","#event_edit_modal #file_del_btn",(function(e){e.preventDefault(),e.stopPropagation(),$(this).closest("li").remove()})),$(document).on("shown.bs.modal","#event_create_modal",(function(){$("#event_create_modal .event_title_input").focus()})),$(document).on("shown.bs.modal","#event_edit_modal",(function(){$("#event_edit_modal .event_title_input").focus()})),$(document).on("click",".event_pop_head .btn",(function(){WebuiPopovers.hideAll()})),$(document).on("click","#calendar_split_right #calendar_v",(function(e){calendar.event_offset_x=e.pageX,calendar.event_offset_y=e.pageY})),$(document).on("click","#calendar_set_menu li",(function(){$("#calendar_set_menu li").removeClass("active"),$(this).addClass("active")})),$(document).on("click","#calendar_set_menu #set_cal_list li",(function(){get_calendar_info($(this).data("cal_seq"),!1)})),$(document).on("click","#calendar_set_contents #cal_lock_btn",(function(){$(this).data("is_lock",!$(this).data("is_lock")),1==$(this).data("is_lock")?$(this).attr("data-i18n","calendar:cal set.unlock"):$(this).attr("data-i18n","calendar:cal set.lock"),$(this).toggleClass("uncheck"),$(this).localize()})),$(document).on("click","#calendar_set_contents #account_add_btn",(function(){let e=new Array;$("#calendar_set_contents .list-group > .list-group-item").each((function(t,a){e.push($(a).data("account_seq"))})),$("#multi_select_modal #contents_title_area h3").remove(),$("#multi_select_modal #contents_title_area").append('<h3 class="over_wrapper text-center" data-i18n="calendar:cal set.manage account"></h3>'),$("#multi_select_modal .modal-footer >").remove(),$("#multi_select_modal .modal-footer").append('<span id="cal_set_account_save_btn" class="pull-right btn btn-primary"\ndata-i18n="calendar:cal set.apply"></span>'),v_account_select_tree($("#multi_select_modal #multi_select_list"),$("#multi_select_modal #multi_select_tree"),e),$("#multi_select_modal").localize(),$("#multi_select_modal").modal()})),$(document).on("click","#calendar_set_contents #cal_update_btn",(function(){let e=$(this).data("cal_seq"),t=$("#calendar_set_contents .cal_title_input").val(),a=$("#calendar_set_contents #cal_note_input").val(),n=Boolean($("#calendar_set_contents #cal_lock_btn").data("is_lock")),l=Boolean($("#calendar_set_contents #is_deadline_btn").data("is_deadline")),c=calendar.get_start_time(!0,$("#calendar_set_contents")),d=calendar.get_end_time(!0,$("#calendar_set_contents")),_=new Array;$("#calendar_set_contents .list-group > .list-group-item").each((function(e,t){_.push($(t).data("account_seq"))}));let s=new Array;$("#calendar_set_contents .cal_share_type_view ").each((function(e,t){s.push($(t).val())})),set_calendar_update((()=>{}),e,t,a,n,null,l,c.unix(),d.unix(),_,s)})),$(document).on("click","#multi_select_modal #cal_set_account_save_btn",(function(){let e=new Array;$("#multi_select_list >").each((function(t,a){e.push($(a).data("account_seq"))}));let t=new Array;$("#calendar_set_contents .list-group > .list-group-item").each((function(e,a){t.push($(a).data("account_seq"))}));let a=e.filter((e=>!t.includes(e))),n=t.filter((t=>!e.includes(t))),l=$("#calendar_set_contents .list-group");v_cal_share_add_account(l,a),v_cal_share_del_account(l,n),$("#multi_select_modal").modal("hide")})),$(document).on("click","#calendar_set_menu #trash_btn",(function(){let e=[];$("#set_cal_list li").each((function(t,a){e.push($(a).data("cal_seq"))})),get_calendar_trash_event_list(e,$("#calendar_set_contents"))})),$(document).on("click",".cal_trash_drop #cal_recover_btn",(function(){set_calendar_recover($(this).closest(".cal_trash_drop").data("cal_seq"))})),$(document).on("click",".cal_trash_drop #cal_remove_btn",(function(){del_calendar_remove($(this).closest(".cal_trash_drop").data("cal_seq"),!0)})),$(document).on("click","#calendar_set_contents #event_all_check_btn",(function(){$(this).toggleClass("checked"),$("i",this).removeClass("fa-minus-square");let e=$("#calendar_set_contents .event_check_btn");1==$(this).hasClass("checked")?($(" i",this).removeClass("fa-square"),$(" i",this).addClass("fa-check-square"),$(e).addClass("checked"),$("i",e).removeClass("fa-square"),$("i",e).addClass("fa-check-square")):($(" i",this).removeClass("fa-check-square"),$(" i",this).addClass("fa-square"),$(e).removeClass("checked"),$("i",e).removeClass("fa-check-square"),$("i",e).addClass("fa-square"))})),$(document).on("click","#calendar_set_contents .event_check_btn",(function(){$(this).toggleClass("checked"),$(" i",this).toggleClass("fa-square"),$(" i",this).toggleClass("fa-check-square");let e=$("#calendar_set_contents .event_check_btn"),t=$("#calendar_set_contents #event_all_check_btn"),a=0,n=0;$(e).each((function(e,t){1==$(t).hasClass("checked")?++a:++n})),0==a?($(t).removeClass("checked"),$("i",t).removeClass("fa-check-square"),$("i",t).removeClass("fa-minus-square"),$("i",t).addClass("fa-square")):0==n?($(t).addClass("checked"),$("i",t).removeClass("fa-square"),$("i",t).removeClass("fa-minus-square"),$("i",t).addClass("fa-check-square")):($(t).removeClass("checked"),$("i",t).removeClass("fa-square"),$("i",t).removeClass("fa-check-square"),$("i",t).addClass("fa-minus-square"))})),$(document).on("click","#calendar_set_contents #all_event_clear_btn",(function(){del_calendar_trash_clear($(this).data("cal_seq"))})),$(document).on("click","#calendar_set_contents #checked_event_remove_btn",(function(){let e=new Array;$("#calendar_set_contents .event_check_btn.checked").each((function(t,a){e.push($(a).data("event_seq"))})),0!=e.length&&del_event_remove(e,!0)})),$(document).on("click","#calendar_set_contents #checked_event_recover_btn",(function(){let e=new Array;$("#calendar_set_contents .event_check_btn.checked").each((function(t,a){e.push($(a).data("event_seq"))})),0!=e.length&&set_calendar_trash_event_recover(e)})),$(document).on("click",".event_trash_drop #event_remove_btn",(function(){del_event_remove([$(this).closest(".event_trash_drop").data("event_seq")],!0)})),$(document).on("click",".event_trash_drop #event_recover_btn",(function(){set_calendar_trash_event_recover([$(this).closest(".event_trash_drop").data("event_seq")])}));