class card_detail_{constructor(){this.card_seq=null,this.card_node=null,this.temp_card_seq=null,this.card_article_seq=null,this.card_contents_seq=null,this.card_timeline_seq=null,this.card_data=null,this.info=null,this.link_info_list=null,this.todo_flow_now=null,this.list_cost_log=null,this.sum_cost_time_under=null,this.sum_cost_time_this=null,this.cost_log_offset=0,this.card_contents=null,this.card_timeline=null,this.current_timeline_contents_seq=null,this.is_scrolltop=!1,this.card_scrolltop=null,this.is_use_comment=null,this.card_title=null,this.is_bookmark=null,this.is_editable=null,this.lcl_obj={},this.lcl_file_list_obj=null,this.lcl_temp_obj=null,this.v_auth_max_count=4,this.type_auth_enum={owner:4,user:2,viewer:1,none:0},this.type_status_enum={ready:1,progress:2,stop:3,cancel:4,complete:5},this.type_priority_enum={urgent:3,high:4,medium:5,low:6,lowest:7},this.front_seq_enum={front:-1,back:-2},this.card_sort_enum={add_time:1,status:2},this.enum_edit_mode={edit:1,view:2},this.enum_link_relation={relate:1,duplicate:2},this.edit_mode=this.enum_edit_mode.view}set_card_info(t){this.info=t,this.card_title=t.title,this.is_editable=t.is_editable,this.is_bookmark=t.is_bookmark,this.list_cost_log=t.list_cost_log,this.sum_cost_time_under=t.sum_cost_time_under,this.sum_cost_time_this=t.sum_cost_time_this,this.link_info_list=t.list_link_info,this.todo_flow_now=t.todo_flow_now}set_card_data(t){this.card_contents_seq=t.contents_seq,this.card_timeline_seq=t.timeline_seq,this.card_article_seq=t.list_article[0].article_seq,this.card_data=t.info,this.is_editable=t.is_editable,this.card_title=t.title,this.is_use_comment=t.is_use_comment}set_card_contents(t){this.card_contents=contents_parser(t.list_article[0].info_article)}set_card_timeline_contents(t){this.card_timeline_contents=t.list_contents_section}set_card_list(t){this.card_list=t,this.card_title=t.title,this.is_editable=t.is_editable;let e=this.card_list.list_card_info.card_seq.length;for(let t=0;t<e;++t)this.card_list.list_card_info.is_deleted[t]=1==this.card_list.list_card_info.is_deleted[t],this.card_list.list_card_info.is_hidden[t]=1==this.card_list.list_card_info.is_hidden[t],this.card_list.list_card_info.is_todo[t]=1==this.card_list.list_card_info.is_todo[t]}set_file_list(t){this.card_file_list=t,this.card_title=t.title,this.is_editable=t.is_editable;let e=this.card_file_list.list_file_info.file_seq.length;for(let t=0;t<e;++t)this.card_file_list.list_file_info.is_preview[t]=1==this.card_file_list.list_file_info.is_preview[t],this.card_file_list.list_file_info.is_deletable[t]=1==this.card_file_list.list_file_info.is_deletable[t]}}let card_detail=new card_detail_;function list_node_click(t,e=!0,a=!0,_=0){if(null!=t&&"5"!=t.data.state){switch(t.setActive(),t.setSelected(),card_detail.edit_mode=card_detail.enum_edit_mode.view,card_detail.card_seq=t.key,card_detail.card_node=t,$("#card-tabs").tabs("enable"),$("#card_detail").data("card_seq",t.key),$("#card_detail").scrollTop(0),init.current_sub_tab){case init.card_tabs_enum.info:card_get_info();break;case init.card_tabs_enum.detail:card_get_timeline($("#tabs-card-info").scrollTop());break;case init.card_tabs_enum.list:get_card_list();break;case init.card_tabs_enum.file:get_card_file_list();break;case init.card_tabs_enum.calendar:card_get_schedule_json();break;case init.card_tabs_enum.log:card_get_log(),card_get_cost_view_user_list();break;default:card_get_info()}split_collapse(init.tree_split,_),$("#card_detail #breadcrumb >").remove(),set_breadcrumb(t.parent,$("#card_detail #breadcrumb")),tree_breadcrumb_dropdown($("#card_detail #breadcrumb"),t),breadcrumb_path_reset($("#card_detail #breadcrumb")),a&&set_history(init.current_main_tab,card_detail.card_seq,null)}}function card_view_handle(t,e=init.info_time_type_enum.card,a=!1,_=tree_data.enum_tree_type.card,i=null){if(_==tree_data.enum_tree_type.card){let _=null;if(e==init.info_time_type_enum.link||e==init.info_time_type_enum.confirm?(card_detail.temp_card_seq=i,_=$("#tree").fancytree("getTree").getNodeByKey(i),$("#card_view_modal").data("type",init.enum_type.card).data("seq",i),$("#card_view_modal #go_card").data("card_seq",i).data("tree_type",tree_data.enum_tree_type.card),$("#card_view_modal #contents_title_area > h3").remove(),$("#card_view_modal #contents_title_area").append(`<h3 class="over_wrapper text-center">${_.title}</h3>`)):(card_detail.temp_card_seq=t,_=$("#tree").fancytree("getTree").getNodeByKey(t),$("#card_view_modal").data("type",init.enum_type.card).data("seq",t),$("#card_view_modal #go_card").data("card_seq",t).data("tree_type",tree_data.enum_tree_type.card),$("#card_view_modal #contents_title_area > h3").remove(),$("#card_view_modal #contents_title_area").append(`<h3 class="over_wrapper text-center">${_.title}</h3>`)),null==_)return swal.fire({title:'<span data-i18n="error:swal.none card"></span>'}),void $(".swal2-container").localize();$("#card_view_modal").modal(),card_get_info_timeline($("#card_view_modal #info_area"),e,view_card_info_timeline,t,i,a,account_list.enum_account_self.self)}else if(_==tree_data.enum_tree_type.note){let e=$("#note_tree").fancytree("getTree").getNodeByKey(t);if(null==e)return swal.fire({title:'<span data-i18n="error:swal.none card"></span>'}),void $(".swal2-container").localize();$("#card_view_modal").modal(),$("#card_view_modal").data("type",init.enum_type.note).data("seq",card_seq),$("#card_view_modal #go_card").data("card_seq",card_seq).data("tree_type",tree_data.enum_tree_type.note),$("#card_view_modal #contents_title_area > h3").remove(),$("#card_view_modal #contents_title_area").append(`<h3 class="over_wrapper text-center">${e.title}</h3>`),note_get_info_timeline(view_note_info_timeline,t,a)}}$(document).on("click","#info_area #card_create_btn",(function(){let t=$("#tree").fancytree("getTree").getSelectedNodes()[0].key;$("#card_create_modal #contents_title_area h3").attr("data-i18n","modal:title.card create"),$("#card_create_modal #create_card_input").attr("data-i18n","[placeholder]modal:input.card title"),$("#card_create_modal").data("tree_type",tree_data.enum_tree_type.card),$("#card_create_modal #create_card_btn").data("card_seq",t),$("#card_create_modal #create_card_close_btn").data("card_seq",t),$("#card_create_modal #create_card_input").data("card_seq",t),$("#create_card_input").val(""),$("#card_create_modal").modal()})),$(document).on("click","#card_detail #card_btn_group #card_title_btn",(function(){let t=$("#tree").fancytree("getTree").getSelectedNodes()[0],e=t.key;$("#card_title_modal #contents_title_area h3").attr("data-i18n","modal:title.card rename"),$("#card_title_modal #title_card_input").attr("data-i18n","[placeholder]modal:input.card title"),$("#card_title_modal").data("tree_type",tree_data.enum_tree_type.card),$("#card_title_modal #title_card_btn").data("card_seq",e),$("#card_title_modal #title_card_close_btn").data("card_seq",e),$("#card_title_modal #title_card_input").data("card_seq",e),$("#title_card_input").val(t.title),$("#card_title_modal").modal()})),$(document).on("click","#card_detail #info_area #card_title_edit",(function(){let t=$(this).parent();const e=$(this).text().trim();$(this).remove(),t.append(`<div class="col-xs-9 compact_row">\n<input id="title_input" type="text" class="form-control input-sm" placeholder=""\nvalue="${e}" data-i18n="[placeholder]card:card title" maxlength="100">\n</div>`),$("#title_input",t).focus()})),$(document).on("keydown","#card_detail #info_area #title_input",(function(t){13==t.keyCode&&$("#info_area #title_input").trigger("focusout")})),$(document).on("focusout","#card_detail #info_area #title_input",(function(){const t=$(this).val().trim();""!=t&&card_detail.card_title!=t?card_set_title(t,card_detail.card_seq):$(this).val(card_detail.card_title)})),$(document).on("click","#info_area #card_move_modal_btn",(function(){$("#card_move_modal").data("tree_type",tree_data.enum_tree_type.card),v_card_duplication_tree($("#tree"),$("#move_tree")),$("#card_move_modal #card_move_btn").data("seq",card_detail.card_seq),$("#card_move_modal").modal()})),$(document).on("click","#card_move_modal #card_move_btn",(function(){let t=$("#move_tree").fancytree("getTree").getSelectedNodes()[0],e=$("#card_move_modal").data("tree_type");if($("#card_move_batch_modal").hasClass("in")){let a=new Array;$("#card_move_batch_modal .list div.active").each((function(t,e){$(e).data("card_seq")&&a.push($(e).data("card_seq"))})),e==tree_data.enum_tree_type.card&&set_card_move_batch(a,t.key),e==tree_data.enum_tree_type.note&&note_set_move_batch(a,t.key)}else e==tree_data.enum_tree_type.card&&card_set_move($(this).data("seq"),t.key),e==tree_data.enum_tree_type.note&&note_set_move($(this).data("seq"),t.key)})),$(document).on("click","#info_area #card_delete_btn",(function(){card_del_remove()})),$(document).on("click","#info_area #card_recover_btn",(function(){card_set_recover()})),$(document).on("click","#info_area #card_hidden_btn",(function(){card_set_hidden()})),$(document).on("click","#info_area #card_set_bookmark_btn",(function(){card_set_bookmark(card_detail.card_seq)})),$(document).on("click","#info_area #card_del_bookmark_btn",(function(){card_del_bookmark(card_detail.card_seq)})),$(document).on("click","#info_area #card_set_lock_btn",(function(){card_set_lock()})),$(document).on("click","#info_area #card_set_todo_btn",(function(){card_set_todo(card_detail.card_seq)})),$(document).on("click","#info_area #card_state_batch_btn",(function(){$("#card_state_batch_select_modal").data("tree_type",tree_data.enum_tree_type.card),v_card_duplication_tree($("#tree"),$("#batch_tree"),card_detail.card_node),$("#card_state_batch_modal #card_state_batch_btn").attr("disabled",!0),$("#card_state_batch_modal #all_select i").removeClass("fa-check-square"),$("#card_state_batch_modal #all_select i").removeClass("fa-square"),$("#card_state_batch_modal #all_select i").addClass("fa-square"),$("#card_state_batch_modal").modal(),$("#batch_tree").fancytree("getTree").visit((function(t){t.setExpanded(!0)}))})),$(document).on("click","#info_area #card_move_batch_btn",(function(){let t=card_detail.card_node.getChildren();$("#card_move_modal").data("tree_type",tree_data.enum_tree_type.card),v_under_list($("#card_move_batch_modal"),t),v_card_duplication_tree($("#tree"),$("#move_tree")),$("#card_move_modal #card_move_btn").data("seq",card_detail.card_node.key),$("#card_move_batch_modal #card_move_batch_btn").attr("disabled",!0),$("#card_move_batch_modal").modal()})),$(document).on("click","#bookmark_list #set_bookmark_btn",(function(t){t.preventDefault(),t.stopPropagation(),$(this).hasClass("fas")?($(this).removeClass("fas"),$(this).addClass("far"),card_del_bookmark($(this).parent().parent().data("card_seq"))):($(this).removeClass("far"),$(this).addClass("fas"),card_set_bookmark($(this).parent().parent().data("card_seq")))})),$(document).on("click","#bookmark_list #go_card",(function(t){t.stopPropagation();let e=$("#card_bookmark_modal").data("tree_type");const a=$(this).parents("div[data-card_seq]").data("card_seq").toString();if(e==tree_data.enum_tree_type.card){let t=$("#tree").fancytree("getTree").getNodeByKey(a.toString());1!=t.data.is_hidden&&1!=t.data.is_deleted||tree_data.tree_hidden||$("#hidden_btn").trigger("click"),list_node_click(t)}else if(e==tree_data.enum_tree_type.note){let t=$("#note_tree").fancytree("getTree").getNodeByKey(a.toString());note_node_click(t)}$(".modal.in").modal("hide")})),$(document).on("click","#bookmark_list .list_item",(function(t){t.stopPropagation();let e=$("#card_bookmark_modal").data("tree_type");e==tree_data.enum_tree_type.card?card_view_handle($(this).data("card_seq").toString(),init.info_time_type_enum.card):e==tree_data.enum_tree_type.note&&card_view_handle($(this).data("card_seq").toString(),null,!1,tree_data.enum_tree_type.note)})),$(document).on("click","#bookmark_list .sort",(function(){$("#bookmark_list .sort .sort_type").remove(),$(this).hasClass("asc")&&$(this).append('<i class="fas fa-sort-up sort_type"></i>'),$(this).hasClass("desc")&&$(this).append('<i class="fas fa-sort-down sort_type"></i>')})),$(document).on("click",".card.card_state_pop #info_ready_btn",(function(){WebuiPopovers.hideAll(),card_set_status(card_detail.type_status_enum.ready)})),$(document).on("click",".card.card_state_pop #info_progress_btn",(function(){WebuiPopovers.hideAll(),card_set_status(card_detail.type_status_enum.progress)})),$(document).on("click",".card.card_state_pop #info_stop_btn",(function(){WebuiPopovers.hideAll(),card_set_status(card_detail.type_status_enum.stop)})),$(document).on("click",".card.card_state_pop #info_cancel_btn",(function(){WebuiPopovers.hideAll(),card_set_status(card_detail.type_status_enum.cancel)})),$(document).on("click",".card.card_state_pop #info_complete_btn",(function(){WebuiPopovers.hideAll(),card_set_status(card_detail.type_status_enum.complete)})),$(document).on("click",".card.card_priority_pop #info_urgent_btn",(function(){WebuiPopovers.hideAll(),card_set_priority(card_detail.type_priority_enum.urgent)})),$(document).on("click",".card.card_priority_pop #info_high_btn",(function(){WebuiPopovers.hideAll(),card_set_priority(card_detail.type_priority_enum.high)})),$(document).on("click",".card.card_priority_pop #info_medium_btn",(function(){WebuiPopovers.hideAll(),card_set_priority(card_detail.type_priority_enum.medium)})),$(document).on("click",".card.card_priority_pop #info_low_btn",(function(){WebuiPopovers.hideAll(),card_set_priority(card_detail.type_priority_enum.low)})),$(document).on("click",".card.card_priority_pop #info_lowest_btn",(function(){WebuiPopovers.hideAll(),card_set_priority(card_detail.type_priority_enum.lowest)})),$(document).on("click","#tabs-tree #add_owner_btn",(function(){$("#single_select_modal #contents_title_area h3").remove(),$("#single_select_modal #contents_title_area").append('<h3 class="over_wrapper text-center" data-i18n="card:auth.select owner"></h3>'),$("#single_select_modal .modal-footer >").remove(),$("#single_select_modal .modal-footer").append(`<div class="between_flex">\n<input class="input-sm form-control" data-i18n="[placeholder]card:auth.comment" maxlength="100">\n<span id="auth_save_btn" class="pull-right btn btn-primary"\ndata-i18n="card:auth.apply" data-card_seq="${card_detail.card_seq}"></span>\n<span id="auth_cancel_btn" class="pull-right btn btn-danger"\ndata-i18n="card:auth.cancel"></span>\n</div>`),v_account_select_tree($("#single_select_modal #single_select_list"),$("#single_select_modal #single_select_tree"),[card_detail.info.owner_account_seq]),$("#single_select_modal").localize(),$("#single_select_modal").modal()})),$(document).on("click","#tabs-tree #owner_flow_btn",(function(){card_get_account_owner_flow(),$("#owner_flow_modal").modal()})),$(document).on("click","#tabs-tree #add_viewer_btn",(function(){$("#multi_select_modal #contents_title_area h3").remove(),$("#multi_select_modal #contents_title_area").append('<h3 class="over_wrapper text-center" data-i18n="card:auth.select viewer"></h3>'),$("#multi_select_modal .modal-footer >").remove(),$("#multi_select_modal .modal-footer").append(`<span id="auth_cancel_btn" class="pull-right btn btn-danger"\ndata-i18n="card:auth.cancel"></span>\n<span id="auth_save_btn" class="pull-right btn btn-primary"\ndata-i18n="card:auth.apply" data-card_seq="${card_detail.card_seq}"></span>`),v_account_select_tree($("#multi_select_modal #multi_select_list"),$("#multi_select_modal #multi_select_tree"),card_detail.info.list_viewer_account_seq),$("#multi_select_modal").localize(),$("#multi_select_modal").modal()})),$(document).on("click","#single_select_modal .unselect_btn",(function(){const t=$(this).data("account_seq");$("#single_select_modal #single_select_tree").fancytree("getTree").visit((function(e){e.data.account_seq==t&&e.setSelected(!1)})),$(this).remove()})),$(document).on("click","#multi_select_modal .unselect_btn",(function(){const t=$(this).data("account_seq");$("#multi_select_modal #multi_select_tree").fancytree("getTree").visit((function(e){e.data.account_seq==t&&e.setSelected(!1)})),$(this).remove()})),$(document).on("click",".select_modal #auth_cancel_btn",(function(){$(".select_modal").modal("hide")})),$(document).on("click","#single_select_modal #auth_save_btn",(function(){let t=tree_data.get_account_selected_seqs($("#single_select_modal #single_select_tree").fancytree("getTree"))[0];null!=t?(card_set_account_owner(t,card_detail.card_seq,$(this).prev("input").val()),$(".select_modal.in").modal("hide")):cs_msg.swal_err("none account")})),$(document).on("click","#multi_select_modal #auth_save_btn",(function(){card_set_account_viewer(tree_data.get_account_selected_seqs($("#multi_select_modal #multi_select_tree").fancytree("getTree"))),$(".select_modal.in").modal("hide")})),$(document).on("change","#tabs-tree #per_done_combobox",(function(t,e){let a=$(this).val();card_set_per_done(a)})),$("#tabs-tree select.calendar_state").on("sumo:closing",(function(){card_get_schedule_json()})),$(document).on("click","#tabs-tree #cal_today_btn",(function(){calendar.card_cal.today()})),$(document).on("click","#tabs-tree #cal_jump_card_btn",(function(){const t=calendar.card_cal.getEventById($("#tree").fancytree("getTree").getSelectedNodes()[0].key);null!=t&&calendar.card_cal.gotoDate(t.start)})),$(document).on("click","#date_input #is_all_day",(function(){$(this).toggleClass("uncheck"),$("#date_input .timepicker").toggleClass("hidden")})),$(document).on("change","#date_input #start_date",(function(){$("#end_date").attr("min",$(this).val())})),$(document).on("change","#date_input #end_date",(function(){$("#start_date").attr("max",$(this).val())})),$(document).on("click","#tabs-tree #card_date_btn",(function(){$("#date_input_modal").data("tree_type",tree_data.enum_tree_type.card),$("#date_input_modal").data("seq",card_detail.card_seq),v_date_input($("#date_input_modal"),moment.unix($(this).data("start_ts")),moment.unix($(this).data("end_ts")),$(this).data("is_allday"),$(this).data("is_repeat"),$(this).data("is_schedule")),$("#date_input_modal").modal()})),$(document).on("click","#card_view_modal #card_date_btn",(function(){$("#date_input_modal").data("tree_type",tree_data.enum_tree_type.card),$("#date_input_modal").data("seq",card_detail.card_seq),v_date_input($("#date_input_modal"),moment.unix($(this).data("start_ts")),moment.unix($(this).data("end_ts")),$(this).data("is_allday"),$(this).data("is_repeat"),$(this).data("is_schedule")),$("#date_input_modal").modal()})),$(document).on("click","#tabs-tree #schedule_del_btn",(function(t){t.stopPropagation(),card_del_schedule(card_detail.card_seq)})),$(document).on("click","#card_view_modal #schedule_del_btn",(function(t){t.stopPropagation(),$("#card_view_modal").data("type")==init.enum_type.card?card_del_schedule($("#card_view_modal").data("seq")):$("#card_view_modal").data("type")==init.enum_type.note&&note_del_schedule($("#card_view_modal").data("seq"))})),$(document).on("timeFormatError","#start_time",(function(){$(this).val("")})),$(document).on("timeFormatError","#end_time",(function(){$(this).val("")})),$(document).on("click","#date_input_modal #date_save_btn",(function(){let t=get_schedule_data($("#date_input_modal"));if(t.start-t.end<=0){let e=$("#date_input_modal").data("seq");$("#date_input_modal").data("tree_type")==tree_data.enum_tree_type.card?card_set_schedule(e,t.is_repeat,t.is_all_day,t.start,t.end,"",0):$("#date_input_modal").data("tree_type")==tree_data.enum_tree_type.note?note_set_schedule(e,t.is_repeat,t.is_all_day,t.start,t.end,"",0):$("#date_input_modal").data("tree_type")==tree_data.enum_tree_type.todo&&todo_set_schedule(e,t.is_repeat,t.is_all_day,t.start,t.end,"",0)}else console.log("faill")})),$(document).on("change","#cost_m",(function(t,e){let a=$(this).parents(".cost_time");60==$(this).val()?($(this).val(0),$("#cost_h",a).val(parseInt($("#cost_h",a).val())+1)):$(this).val()<0&&0<$("#cost_h",a).val()&&($(this).val(50),$("#cost_h",a).val(parseInt($("#cost_h",a).val())-1)),$(this).val()<0&&$(this).val(0)})),$(document).on("click","#set_cost",(function(){set_cost_insert(60*parseInt($("#cost_h").val())+parseInt($("#cost_m").val()),$.trim($("#cost_note").val()))})),$(document).on("click","#cost_modify_btn",(function(){v_cost_modify($(this))})),$(document).on("click","#cost_del_btn",(function(){del_cost($(this).parents(".list_item").data("cost_seq"))})),$(document).on("click","#cost_update_btn",(function(){let t=$(this).parents(".list_item");set_cost_update(t.data("cost_seq"),60*parseInt($("#cost_h",t).val())+parseInt($("#cost_m",t).val()),$.trim($("#cost_note",t).val()))})),$(document).on("click","#cost_cancel_btn",(function(){get_cost_list(cost_card_seq())})),$(document).on("hide.bs.modal","#cost_list_modal",(function(){switch(init.current_main_tab){case init.main_tabs_enum.tree:list_node_click($("#tree").fancytree("getTree").getNodeByKey($("#card_detail").data("card_seq")),!0);break;case init.main_tabs_enum.todo:card_get_info(todo_card_info,todo.todo_card_seq)}})),$(document).on("click","#tabs-tree #cost_view_btn",(function(){let t=$(this).closest(".info_form").data("card_seq");card_detail.is_editable?(get_cost_list(t),$("#cost_list_modal").modal()):(get_cost_view(t),$("#cost_view_modal").modal())})),$(document).on("click","#cost_under_btn",(function(){let t=$(this).closest(".info_form").data("card_seq");get_cost_list_depth1(t),$("#cost_under_modal").modal()})),$(document).on("click","#link_area #link_del_btn",(function(t){t.preventDefault(),t.stopPropagation(),del_link($(this).data("link_seq"),card_detail.card_seq)})),$(document).on("show.bs.modal","#card_link_modal",(function(){$("#card_link_modal #link_type_select").remove(),$("#card_link_modal .modal-footer").prepend('<select id="link_type_select">\n<option value="1" data-i18n="card:link.relate" selected></option>\n<option value="2" data-i18n="card:link.duplicate"></option>\n</select>'),$("#card_link_modal #link_type_select").localize()})),$(document).on("click","#link_area #link_create_veiw",(function(){$("#card_link_modal").modal(),v_card_duplication_tree($("#tree"),$("#link_tree"))})),$(document).on("click","#card_link_modal #card_select_btn",(function(){let t=$("#link_tree").fancytree("getTree").getSelectedNodes()[0];$("#link_card_title").data("target_card_seq",t.key),$("#link_card_title").text(t.title),set_link(t.key,$("#link_type_select").val()),$("#card_link_modal").modal("hide")})),$(document).on("click","#link_area .row",(function(t){const e=$(this).find("#view_contents_btn");card_view_handle(e.data("link_seq").toString(),init.info_time_type_enum.link,!1,tree_data.enum_tree_type.card,e.data("card_seq").toString()),t.preventDefault(),t.stopPropagation()})),$(document).on("click","#card_contents #note_edit_btn",(function(){card_detail.edit_mode=card_detail.enum_edit_mode.edit,card_get_timeline($("#tabs-card-info").scrollTop())})),$(document).on("click","#card_contents #note_view_btn",(function(){card_detail.edit_mode=card_detail.enum_edit_mode.view,card_get_timeline($("#tabs-card-info").scrollTop())})),$(document).on("click","#timeline_area .input_chain",(function(){v_comment($(this).parent())})),$(document).on("click","#comment_cancel_btn",(function(){$("#timeline_area>.row").remove(),v_comment_chain($("#timeline_area")),$("#timeline_area .input_chain").localize()})),$(document).on("click","#create_article_reply_btn",(function(){let t=[];$("#reply_to_account > .account_close_btn").each((function(e,a){t.push($(a).data("account_seq"))}));let e=[];$("#reply_file_zone > div").each((function(t,a){e.push($(a).data("file_seq"))})),timeline_set_create_article_reply(card_detail.card_article_seq,$("#card_contents #comment_input").val(),t,e)})),$(document).on("click",".reply_edit_btn",(function(){$("#timeline_area .btn").attr("disabled",!0);let t=$(this).closest("#media_body"),e=$("#comment_note p",t).text(),a=$("#comment_note",t),_=$("#v_reply_to_account",t),i=$("#v_file_list",t);$(">",a).remove(),$("#reply_btn_group",t).remove(),$(".moment_time",t).remove(),$(".lts_time",t).remove(),$(t).addClass("cs_border label_relative");let c=$(this).data("article_reply_seq");$(a).append(`<div class="row">\n<textarea id="comment_input" class="comment_input" maxlength="5000" data-i18n="[placeholder]card:reply.add comment">\n${e}\n</textarea>\n</div>`),$("#comment_input",a).val(e),$("#comment_input",a).focus(),$(i).append('<div id="reply_modify_file_zone"></div>'),$(" > li",i).each((function(t,e){$(e).append('<div id="file_del_btn" class="btn"><i class="fas fa-times fa-lg text-danger"></i></div>')}));let n=[];$(".account_li",_).each((function(t,e){n.push($(e).data("account_seq"))})),$(">",_).remove(),set_account_breadcrumb(n,$(_)),t.append('<div class="reply_btn_group">\n<div id="reply_modify_to_add_btn" class="btn btn-default btn-sm btn-unborder">\n<i class="fas fa-user fa-lg"></i>\n</div>\n<div id="reply_modify_file_add_btn" class="btn btn-default btn-sm btn-unborder">\n<i class="fas fa-paperclip fa-lg"></i>\n</div>\n<div class="pull-right">\n<div id="reply_edit_save_btn" class="btn btn-primary btn-sm">\n<i class="fas fa-plus fa-lg"></i><span data-i18n="card:contents.comments"></span>\n</div>\n<div id="reply_edit_cancel_btn" class="btn btn-danger btn-sm">\n<i class="fas fa-ban fa-lg"></i><span data-i18n="card:contents.comments"></span>\n</div>\n</div>\n</div>\n<div id="dropzone_msg" class="text-center">\n<div>\n<div><i class="fas fa-cloud-upload-alt fa-4x"></i></div>\n<h4 data-i18n="cs:drop upload"></h4>\n</div>\n</div>'),article_file_dropzone($(t),'#timeline_area .media > div[data-article_reply_seq="'+c+'"] #reply_modify_file_zone','#timeline_area .media > div[data-article_reply_seq="'+c+'"] #reply_modify_file_add_btn'),t.localize()})),$(document).on("click",".reply_del_btn",(function(){timeline_del_article_reply(card_detail.card_article_seq,$(this).closest(".media-body").data("article_reply_seq"))})),$(document).on("click","#reply_edit_save_btn",(function(){let t=$(this).closest(".media-body"),e=[],a=[];$("#v_reply_to_account > .account_close_btn",t).each((function(t,a){e.push($(a).data("account_seq"))})),$("#v_file_list > li",t).each((function(t,e){a.push($(e).data("file_seq"))})),$("#reply_modify_file_zone > div",t).each((function(t,e){a.push($(e).data("file_seq"))})),timeline_set_update_article_reply(card_detail.card_article_seq,t.data("article_reply_seq"),$("#comment_input",t).val(),e,a)})),$(document).on("click","#reply_edit_cancel_btn",(function(){timeline_get_article_reply(card_detail.card_article_seq)})),$(document).on("click","#v_file_list #file_del_btn",(function(){$(this).parent().remove()})),$("#card_view_modal").on("hidden.bs.modal",(function(){$("#card_view_modal #contents_area >").remove()})),$(".modal").on("shown.bs.modal",(function(){$(".modal-body").scrollTop(0)})),$(document).on("click","#card_detail #card_list_hidden",(function(){get_card_list()})),$("#card_detail select.select_auth").on("sumo:closing",(function(){get_card_list()})),$("#card_detail select.select_state").on("sumo:closing",(function(){get_card_list()})),$("#card_detail select.select_column").on("sumo:closing",(function(){$("option:not(:selected)",this).each((function(t,e){card_list_table.column($(e).val()).visible(!1)})),$(this).val().some((function(t){card_list_table.column(t).visible(!0)}))})),$(document).on("click","#card_detail #include_under_btn",(function(){get_card_file_list()})),$("#card_detail select.select_pos").on("sumo:closing",(function(){get_card_file_list()})),$(document).on("click","#space_setting_btn",(function(){window.open(`/mspace/${space_seq}`)})),$(document).on("click","#set_profile_btn",(function(){let t=account_list.account;$("#profile_edit_modal .modal-body >").remove(),$("#profile_edit_modal .modal-body").append(`<div class="photo_md">\n<img src="${t.photo_url}" class="img-circle user_photo"></div>\n<div>\n<label data-i18n="tree:account.name"></label>\n<input type="text" class="form-control input-sm" value="${t.name}">\n</div>\n<div>\n<label data-i18n="tree:account.intro"></label>\n<textarea type="text" class="form-control" id="profile_intro" maxlength="5000"\nrows="6" placeholder="" data-i18n="[placeholder]tree:account.intro">${t.intro}</textarea>\n</div>`),$("#profile_edit_modal").modal(),$("#profile_edit_modal").localize()})),$(document).on("click","#profile_edit_modal #account_set_profile_btn",(function(){account_set_profile_space($("#profile_edit_modal input").val(),$("#profile_edit_modal textarea").val())})),$(document).on("click","#file_down_btn",(function(t){t.preventDefault(),t.stopPropagation(),window.location.replace("/file_down/"+space_seq+"/"+$(this).data("file_seq")+"/1")})),$(document).on("click","#log_list_modal #log_depth_btn",(function(){$("#log_list_modal #log_list >").remove(),card_get_log($("#log_list_modal #log_list"),card_detail.card_seq,$("#log_list_modal #log_depth_btn input:first").is(":checked"),0,!1,20)})),$("#log_list_modal .modal-body").scroll((function(){let t=$(this).scrollTop(),e=$(this)[0].clientHeight,a=$(this)[0].scrollHeight;0<t&&a<=t+e&&card_get_log($("#log_list_modal #log_list"),card_detail.card_seq,$("#log_list_modal #log_depth_btn input:first").is(":checked"),$(".log_item:last",this).data("zlog_seq"),!0,20)})),$("#cost_log_list_modal .modal-body").scroll((function(){let t=$(this).scrollTop(),e=$(this)[0].clientHeight,a=$(this)[0].scrollHeight;0<t&&a<=t+e&&(card_detail.cost_log_offset+=20,card_get_cost_view_log_cost_list(card_detail.cost_log_offset,!0))})),$(document).on("click","#card_detail #log_more_btn",(function(){$("#log_list_modal #log_list >").remove(),card_get_log($("#log_list_modal #log_list"),card_detail.card_seq,$("#log_list_modal #log_depth_btn input:first").is(":checked"),0,!1,20),$("#log_list_modal").modal()})),$(document).on("click","#card_detail #cost_more_btn",(function(){card_get_cost_view_log_cost_list()})),$(document).on("click","#card_detail #user_cost_btn",(function(){card_get_cost_view_user_card_list($(this).data("account_seq"))})),$(document).on("click",".card_list_item",(function(){card_view_handle($(this).data("card_seq").toString(),init.info_time_type_enum.card)}));