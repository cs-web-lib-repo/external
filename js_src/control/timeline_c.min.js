class contents_data_{constructor(){this.contents_seq=null,this.article_seq=null,this.data=null,this.quill=null,this.is_quill_change=!1,this.markdown_editor=null,this.markdown_editor_data=null,this.markdown_viewer=null,this.max_markdown_char=5e3,this.gallery_index=0,this.type_section_enum={note:1,file:2,check_list:3},this.front_seq_enum={front_seq:-1,last_seq:-2},this.target_front_seq=this.front_seq_enum.front_seq,this.clipdata=null}set_contents_seq(t){this.article_seq=t}init_gallery_index(){this.gallery_index=0}}let contents_data=new contents_data_;$(document).on("click","#card_detail #contents_area #edit_note",(function(){let t=$(this).parent().data("section_seq");v_section_edit($(this).parent()),$("#markdown_editor_modal #contents_title_area h3").text(card_detail.card_node.title),$("#markdown_editor_modal").data("section_seq",t),$("#markdown_editor_modal #editor_save_btn").data("",t),$("#markdown_editor_modal").modal()})),$(document).on("click","#card_detail #del_section_btn",(function(){timeline_del_article_section($(this).parents(".list-group-item"))})),$(document).on("click","#card_detail #note_create_btn",(function(){timeline_set_article_section_create_note($(this).parents("#contents_area"),$(this).parents("#card_contents").data("article_seq"),contents_data.type_section_enum.note,$(this).parents(".list-group-item").data("section_seq"),$(this).parents("#tabs-card-info").scrollTop())})),$(document).on("shown.bs.modal","#markdown_editor_modal",(function(){$(this).data("is_pass",!1),contents_data.markdown_editor.focus()})),$(document).on("hide.bs.modal","#markdown_editor_modal",(function(t){let e=contents_data.markdown_editor.getMarkdown();if(0==$(this).data("is_pass")&&e!=contents_data.markdown_editor_data)return contents_data.max_markdown_char<e.length?cs_msg.swal_deny_select("over char?","over char save","",(()=>timeline_set_article_note($("#markdown_editor_modal").data("section_seq"),e)),(()=>{}),(()=>{$(this).data("is_pass",!0),$(this).modal("hide")})):cs_msg.swal_deny_select("save?","","",(()=>timeline_set_article_note($("#markdown_editor_modal").data("section_seq"),e)),(()=>{}),(()=>{$(this).data("is_pass",!0),$(this).modal("hide")})),!1})),$(document).on("click","#markdown_editor_modal #editor_save_btn",(function(){let t=$(this).closest("#markdown_editor_modal").data("section_seq"),e=contents_data.markdown_editor.getMarkdown();e==contents_data.markdown_editor_data?$("#markdown_editor_modal").modal("hide"):contents_data.max_markdown_char<e.length?cs_msg.swal_deny_select("over char?","over char save","",(()=>timeline_set_article_note($("#markdown_editor_modal").data("section_seq"),e)),(()=>{}),(()=>{$("#markdown_editor_modal").data("is_pass",!0),$("#markdown_editor_modal").modal("hide")})):timeline_set_article_note(t,e)})),$(document).on("click","#markdown_editor_modal #editor_apply_btn",(function(){let t=$(this).closest("#markdown_editor_modal").data("section_seq"),e=contents_data.markdown_editor.getMarkdown();timeline_set_article_note(t,e,!1)})),$(document).on("click","#markdown_editor_modal #editor_cancel_btn",(function(){$("#markdown_editor_modal").data("is_pass",!0),$("#markdown_editor_modal").modal("hide")})),$(document).on("click","#reply_to_add_btn",(function(){$("#multi_select_modal #contents_title_area h3").remove(),$("#multi_select_modal #contents_title_area").append('<h3 class="over_wrapper text-center" data-i18n="card:auth.select viewer"></h3>'),$("#multi_select_modal .modal-footer >").remove(),$("#multi_select_modal .modal-footer").append('<span id="auth_cancel_btn" class="pull-right btn btn-danger"\ndata-i18n="card:auth.cancel"></span>\n<span id="reply_to_save_btn" class="pull-right btn btn-primary"\ndata-i18n="card:auth.apply"></span>');let t=[];$("#reply_to_account > .account_close_btn").each((function(e,a){t.push($(a).data("account_seq"))})),v_account_select_tree($("#multi_select_modal #multi_select_list"),$("#multi_select_modal #multi_select_tree"),t),$("#multi_select_modal").localize(),$("#multi_select_modal").modal()})),$(document).on("click","#timeline_area .account_close_btn",(function(){$(this).remove()})),$(document).on("click","#reply_to_save_btn",(function(){let t=[];$("#multi_select_list >").each((function(e,a){t.push($(a).data("account_seq"))})),set_account_breadcrumb(t,$("#reply_to_account")),$("#multi_select_modal").modal("hide")})),$(document).on("click","#reply_modify_to_add_btn",(function(){$("#multi_select_modal #contents_title_area h3").remove(),$("#multi_select_modal #contents_title_area").append('<h3 class="over_wrapper text-center" data-i18n="card:auth.select viewer"></h3>'),$("#multi_select_modal .modal-footer >").remove(),$("#multi_select_modal .modal-footer").append('<span id="auth_cancel_btn" class="pull-right btn btn-danger"\ndata-i18n="card:auth.cancel"></span>\n<span id="reply_modify_to_save_btn" class="pull-right btn btn-primary"\ndata-i18n="card:auth.apply"></span>');let t=[];$("#timeline_area .cs_border #v_reply_to_account > .account_close_btn").each((function(e,a){t.push($(a).data("account_seq"))})),v_account_select_tree($("#multi_select_modal #multi_select_list"),$("#multi_select_modal #multi_select_tree"),t),$("#multi_select_modal").localize(),$("#multi_select_modal").modal()})),$(document).on("click","#reply_modify_to_save_btn",(function(){let t=[];$("#multi_select_list >").each((function(e,a){t.push($(a).data("account_seq"))})),set_account_breadcrumb(t,$("#timeline_area .cs_border #v_reply_to_account")),$("#multi_select_modal").modal("hide")})),$(document).on("click","#file_create_btn",(function(){contents_data.target_front_seq=$(this).parents(".list-group-item").data("section_seq")})),$(document).on("click","#card-tabs #file_rename_btn",(function(){$("#contents_edit .btn").prop("disabled",!0);let t=$(this).parent(),e=$("#file_edit_section a",t).text(),a=$("#file_edit_section a",t).data("file_seq");e=e.trim(),t.children(".btn").remove(),t.children("#file_edit_section").children(":not(img)").remove(),t.prepend(`<button id="file_name_save_btn" class="btn btn-primary btn-sm" data-file_seq="${a}">\n<i class="fas fa-save"></i> Save\n</button>\n<button class="btn btn-danger cancel_section_btn btn-sm pull-right">\n<i class="fas fa-ban"></i> Cancel\n</button>\n<input id="file_name_input" type="text" class="form-control" placeholder="card title" value="${e} maxlength="255"">`)})),$(document).on("click","#card-tabs #file_name_save_btn",(function(){let t=$(this).parent().children("input").val(),e=$(this).data("file_seq");set_file_rename(e,t)})),$(document).on("click","#card_link_contents_modal #go_card",(function(){let t=$("#tree").fancytree("getTree").getNodeByKey($(this).data("card_seq").toString());1!=t.data.is_hidden&&1!=t.data.is_deleted||tree_data.tree_hidden||$("#hidden_btn").trigger("click"),tree_data.active_key=t.key,list_node_click(t,!0),$(".modal.in").modal("hide")})),$(document).on("click","#card_view_modal #go_card",(function(){let t=$(this).closest(".modal"),e=t.data("seq"),a=t.data("type");if(a==init.enum_type.card){let t=$("#tree").fancytree("getTree").getNodeByKey(e);tree_data.active_key=t.key,$("#tabs").tabs({active:init.main_tabs_enum.tree}),1!=t.data.is_hidden&&1!=t.data.is_deleted||tree_data.tree_hidden||$("#hidden_btn").trigger("click"),list_node_click(t)}else if(a==init.enum_type.note){let t=$("#note_tree").fancytree("getTree").getNodeByKey(e);$("#tabs").tabs({active:init.main_tabs_enum.note}),note_node_click(t)}$(".modal.in").modal("hide")})),$(document).on("click","#note_detail #contents_area #edit_note",(function(){let t=$(this).parent().data("section_seq");v_section_edit($(this).parent()),$("#markdown_editor_modal #contents_title_area h3").text(note.note_node.title),$("#markdown_editor_modal").data("section_seq",t),$("#markdown_editor_modal").modal()})),$(document).on("click","#note_detail #del_section_btn",(function(){timeline_del_article_section($(this).parents(".list-group-item"))})),$(document).on("click","#note_detail #file_create_btn",(function(){contents_data.target_front_seq=$(this).parents(".list-group-item").data("section_seq")})),$(document).on("click","#note_detail #file_rename_btn",(function(){$("#contents_edit .btn").prop("disabled",!0);let t=$(this).parent(),e=$("#file_edit_section a",t).text(),a=$("#file_edit_section a",t).data("file_seq");e=e.trim(),t.children(".btn").remove(),t.children("#file_edit_section").children(":not(img)").remove(),t.prepend(`<button id="file_name_save_btn" class="btn btn-primary btn-sm" data-file_seq="${a}">\n<i class="fas fa-save"></i> Save\n</button>\n<button class="btn btn-danger cancel_section_btn btn-sm pull-right">\n<i class="fas fa-ban"></i> Cancel\n</button>\n<input id="file_name_input" type="text" class="form-control" placeholder="card title" value="${e}" maxlength="100">`)})),$(document).on("click","#note_detail #file_name_save_btn",(function(){let t=$(this).parent().children("input").val(),e=$(this).data("file_seq");set_file_rename(e,t)})),$(document).on("show.bs.dropdown","#section_add_dropdown",(async t=>{if(!navigator.clipboard)return;const e=$("#clipboard_btn",t.currentTarget);try{const t=await navigator.clipboard.read();for(const a of t)for(const t of a.types){const n=await a.getType(t);contents_data.clipdata=n,-1!=t.indexOf("image")?e.attr("disabled",!1):e.attr("disabled",!0)}}catch(t){e.attr("disabled",!0)}})),$(document).on("click","#clipboard_btn:not([disabled=disabled])",(function(t){t.preventDefault(),t.stopPropagation();let e=Dropzone.forElement($(this).closest("#contents_area")[0]);contents_data.target_front_seq=$(this).closest(".list-group-item").data("section_seq"),contents_data.clipdata.name=moment().format("YYYY_MM_DD__HH_mm_ss")+".jpg",e.addFile(contents_data.clipdata)}));