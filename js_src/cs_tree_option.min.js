class tree_option_{constructor(){this.filter_str="",this.enum_tree_options={auth:"is_tree_auth",status:"is_tree_status",priority:"is_tree_priority",lock:"is_tree_lock"},this.front_seq_enum={front:-1,back:-2},this.enum_todo_action={owner:1,status:2,state:3},this.enum_todo_state={normal:1,remove:2}}get_tree_option_auth(){return null==JSON.parse(localStorage.getItem(this.enum_tree_options.auth))&&this.set_tree_option(this.enum_tree_options.auth,!0),JSON.parse(localStorage.getItem(this.enum_tree_options.auth))}get_tree_option_status(){return null==JSON.parse(localStorage.getItem(this.enum_tree_options.status))&&this.set_tree_option(this.enum_tree_options.status,!0),JSON.parse(localStorage.getItem(this.enum_tree_options.status))}get_tree_option_priority(){return null==JSON.parse(localStorage.getItem(this.enum_tree_options.priority))&&this.set_tree_option(this.enum_tree_options.priority,!1),JSON.parse(localStorage.getItem(this.enum_tree_options.priority))}get_tree_option_lock(){return null==JSON.parse(localStorage.getItem(this.enum_tree_options.lock))&&this.set_tree_option(this.enum_tree_options.lock,!1),JSON.parse(localStorage.getItem(this.enum_tree_options.lock))}get_tree_option_count(){return this.tree_icon_count}set_tree_option_count(){let e=0;this.get_tree_option_auth()&&++e,this.get_tree_option_status()&&++e,this.get_tree_option_priority()&&++e,this.tree_icon_count=e}set_tree_option(e=this.enum_tree_options.auth,t=!1){localStorage.setItem(e,t)}set_toggle_tree_option(e){let t=JSON.parse(localStorage.getItem(e));return null==t?this.set_tree_option(e):this.set_tree_option(e,!t),this.set_tree_option_count(),JSON.parse(localStorage.getItem(e))}v_tree_option_unchek(e,t=!0){t?e.removeClass("uncheck"):e.addClass("uncheck")}}let tree_option=new tree_option_;function get_nodes_title(e,t=!1){let r="",_=e.length;for(let o=0;o<_;++o)r+=`<li class="list-group-item over_wrapper" data-node_seq="${e[o].key}" data-tree_type="${e[o].data.tree_type}">\n${1==t?"#"+e[o].key:""}${get_tree_icon(e[o])}<span class="${get_tree_title_color_class(e[o])} node_title">${e[o].title}</span></li>`;return r}function v_card_search(e,t,r,_){if(""==e)return void WebuiPopovers.updateContent(r,`<ul class="card_search_ul list-group ${_}" data-i18n="card:no data">none</ul>`);let o=[],i=[];1==/^-?\d+$/.test(e)&&(o=t.findAll((function(t){if(t.key==e)return!0}))),i=t.findAll(e),0==i.length&&0==o.length?WebuiPopovers.updateContent(r,`<ul class="card_search_ul list-group ${_}" data-i18n="card:no data">none</ul>`):WebuiPopovers.updateContent(r,`<ul class="card_search_ul list-group ${_}">${get_nodes_title(o,!0)}${get_nodes_title(i)}</ul>`),r.webuiPopover("show")}tree_option.set_tree_option_count(),$(document).on("click","#tree_setting_btn",(function(e){tree_option.get_tree_option_auth()?$("#tree_set_mode #set_tree_auth_btn").removeClass("uncheck"):$("#tree_set_mode #set_tree_auth_btn").addClass("uncheck"),tree_option.get_tree_option_status()?$("#tree_set_mode #set_tree_status_btn").removeClass("uncheck"):$("#tree_set_mode #set_tree_status_btn").addClass("uncheck"),tree_option.get_tree_option_priority()?$("#tree_set_mode #set_tree_priority_btn").removeClass("uncheck"):$("#tree_set_mode #set_tree_priority_btn").addClass("uncheck"),tree_option.get_tree_option_lock()?$("#tree_set_mode #set_tree_lock_btn").removeClass("uncheck"):$("#tree_set_mode #set_tree_lock_btn").addClass("uncheck"),$("#tree_set_mode").removeClass("hidden"),$("#default_mode").addClass("hidden")})),$(document).on("click","#tree_set_mode #set_tree_auth_btn",(function(){tree_option.set_toggle_tree_option(tree_option.enum_tree_options.auth),tree_option.v_tree_option_unchek($("#tree_set_mode #set_tree_auth_btn"),tree_option.get_tree_option_auth()),$("#tree").fancytree("getTree").render()})),$(document).on("click","#tree_set_mode #set_tree_status_btn",(function(){tree_option.set_toggle_tree_option(tree_option.enum_tree_options.status),tree_option.v_tree_option_unchek($("#tree_set_mode #set_tree_status_btn"),tree_option.get_tree_option_status()),$("#tree").fancytree("getTree").render()})),$(document).on("click","#tree_set_mode #set_tree_priority_btn",(function(){tree_option.set_toggle_tree_option(tree_option.enum_tree_options.priority),tree_option.v_tree_option_unchek($("#tree_set_mode #set_tree_priority_btn"),tree_option.get_tree_option_priority()),$("#tree").fancytree("getTree").render()})),$(document).on("click","#tree_set_mode #set_tree_lock_btn",(function(){tree_option.set_toggle_tree_option(tree_option.enum_tree_options.lock),tree_option.v_tree_option_unchek($("#tree_set_mode #set_tree_lock_btn"),tree_option.get_tree_option_lock()),$("#tree").fancytree("getTree").render()})),$(document).on("click","#tree_set_mode .close_setting",(function(){$("#tree_set_mode").addClass("hidden"),$("#tree_filter_mode").addClass("hidden"),$("#default_mode").removeClass("hidden")})),$(document).on("click","#tree_filter_mode .close_setting",(function(){$("#tree_set_mode").addClass("hidden"),$("#tree_filter_mode").addClass("hidden"),$("#default_mode").removeClass("hidden"),$("#tree_filter_mode #filter_input").val(""),WebuiPopovers.updateContent($("#tree_filter_mode #filter_input"),'<ul class="card_search_ul list-group card_tree" data-i18n="card:no data">none</ul>')})),$(document).on("click","#tree_fillter_btn",(function(){$("#tree_filter_mode").removeClass("hidden"),$("#default_mode").addClass("hidden"),tree_data.tree_hidden||$("#hidden_btn").trigger("click"),$("#tree_filter_mode #filter_input").focus()})),$(document).on("keyup","#tree_filter_mode #filter_input",(function(e){switch(e.stopPropagation(),e.keyCode){case 13:{if(0==$(".card_search_ul.card_tree li.active").length){const e=$(this).val();return void(1==/^-?\d+$/.test(e)&&(list_node_click($("#tree").fancytree("getTree").getNodeByKey(e),!0),$(this).focus()))}let e=$("#tree").fancytree("getTree").getNodeByKey($(".card_search_ul.card_tree li.active").data("node_seq").toString());list_node_click(e,!0),0==init.is_web?(WebuiPopovers.hide("#tree_filter_mode #filter_input"),$("#tree_filter_mode #filter_input").blur()):$("#tree_filter_mode #filter_input").focus();break}case 27:WebuiPopovers.hide("#tree_filter_mode #filter_input");break;case 38:case 40:break;default:v_card_search($("#tree_filter_mode #filter_input").val(),$("#tree").fancytree("getTree"),$("#tree_filter_mode #filter_input"),"card_tree")}})),$(document).on("keydown","#tree_filter_mode #filter_input",(function(e){switch(e.stopPropagation(),e.keyCode){case 38:if(e.preventDefault(),e.stopPropagation(),1==$(".card_search_ul.card_tree li").hasClass("active")){let e=$(".card_search_ul.card_tree li.active").prev();$(".card_search_ul.card_tree li.active").removeClass("active"),e.addClass("active"),e[0].scrollIntoViewIfNeeded(!1)}else $(".card_search_ul.card_tree li:last-child").addClass("active");break;case 40:if(e.preventDefault(),e.stopPropagation(),1==$(".card_search_ul.card_tree li").hasClass("active")){let e=$(".card_search_ul.card_tree li.active").next();$(".card_search_ul.card_tree li.active").removeClass("active"),e.addClass("active"),e[0].scrollIntoViewIfNeeded(!1)}else $(".card_search_ul.card_tree li:first-child").addClass("active")}})),$(document).on("click",".card_search_ul.card_tree li",(function(){$(".card_search_ul.card_tree li").removeClass("active"),$(this).addClass("active");let e=$("#tree").fancytree("getTree").getNodeByKey($(this).data("node_seq").toString());list_node_click(e,!0),0==init.is_web?(WebuiPopovers.hide("#tree_filter_mode #filter_input"),$("#tree_filter_mode #filter_input").blur()):$("#tree_filter_mode #filter_input").focus()})),$(document).on("click","#tree_filter_mode #filter_btn",(function(){v_card_search($("#tree_filter_mode #filter_input").val(),$("#tree").fancytree("getTree"),$("#tree_filter_mode #filter_input"),"card_tree")}));