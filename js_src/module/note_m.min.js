function note_get_note_tree(){$.ajax({url:"/note_get_note_tree",method:"POST",data:{space_seq:space_seq,note_seq:"note_seq"},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}var main_note_list=function(e){v_note_list(e.list_note_info)};function note_get_note_list(e=main_note_list,t,_=$("#note_list_hidden input:first").is(":checked"),n=$("#note_list_hidden input:last").is(":checked"),s=$("#note_list_select select.select_state").val(),a=account_list.enum_account_self.self){$.ajax({url:"/note_get_note_list",method:"POST",data:{space_seq:space_seq,note_seq:t,is_all_depth:n,is_include_delete:_,filter_status:s,target_account_seq:a},success:function(t){0==t.ec?e(t):cs_msg.noti_err(t.ec)},dataType:"json"})}function note_get_note_file(e,t=$("#tabs-note-file-list #include_under_btn input").is(":checked"),_=$("#tabs-note-file-list select.select_pos").val(),n=account_list.enum_account_self.self){$.ajax({url:"/note_get_note_file",method:"POST",data:{space_seq:space_seq,note_seq:e,is_include_under:t,type_preview:init.enum_preview_size.w100,filter_type:_,target_account_seq:n},success:function(e){0==e.ec?(null!=e.list_file_info&&(note.lcl_obj=v_gallery(e.list_file_info)),v_note_file_list(e)):cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_create(e,t,_){""!=(_=_.trim())&&$.ajax({url:"/note_set_create",method:"POST",async:!1,data:{space_seq:space_seq,pnote_seq:t,title:_},success:function(t){0==t.ec?(e.val(""),tree_data.note_create_key=t.note_seq):cs_msg.noti_err(t.ec)},dataType:"json"})}function note_set_move(e,t){$.ajax({url:"/note_set_move",method:"POST",data:{space_seq:space_seq,src_note_seq:e,dst_note_seq:t},success:function(e){0==e.ec?$("#card_move_modal").modal("hide"):cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_move_batch(e,t){$.ajax({url:"/note_set_move_batch",method:"POST",data:{space_seq:space_seq,src_note_seq:e,dst_note_seq:t},success:function(e){0==e.ec?($("#card_move_batch_modal").modal("hide"),$("#card_move_modal").modal("hide")):cs_msg.noti_err(e.ec)},dataType:"json"})}function note_del_remove(e){cs_msg.swal_select((function(){$.ajax({url:"/note_del_remove",method:"POST",data:{space_seq:space_seq,note_seq:e},success:function(t){0==t.ec||(61==t.ec?cs_msg.swal_select((function(){$.ajax({url:"/note_del_remove",method:"POST",data:{space_seq:space_seq,note_seq:e},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}),"force","force ex","force comp"):cs_msg.noti_err(t.ec))},dataType:"json"})}))}function note_del_remove_batch(){$.ajax({url:"/note_del_remove_batch",method:"POST",data:{space_seq:space_seq,note_seq:"note_seq"},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_recover(e){$.ajax({url:"/note_set_recover",method:"POST",data:{space_seq:space_seq,note_seq:e},success:function(e){0==e.ec?note_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_recover_batch(){$.ajax({url:"/note_set_recover_batch",method:"POST",data:{space_seq:space_seq,note_seq:"note_seq"},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_title(e,t){$.ajax({url:"/note_set_title",method:"POST",data:{space_seq:space_seq,note_seq:t,title:e},success:function(e){0==e.ec?note_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function note_get_state(){$.ajax({url:"/note_get_state",method:"POST",data:{space_seq:space_seq,note_seq:"note_seq"},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_status(e,t){$.ajax({url:"/note_set_status",method:"POST",data:{space_seq:space_seq,note_seq:t,status:e},success:function(t){0==t.ec?note_get_info():61==t.ec?cs_msg.swal_select((function(){$.ajax({url:"/note_set_status",method:"POST",data:{space_seq:space_seq,card_seq:card_seq,status:e},success:function(e){0==e.ec?note_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}),"force","force ex","force comp"):(note_get_info(),cs_msg.noti_err(t.ec))},dataType:"json"})}function note_set_status_batch(e,t){$.ajax({url:"/note_set_status_batch",method:"POST",data:{space_seq:space_seq,note_seq:e,status:t},success:function(e){0==e.ec?($("#card_state_batch_modal").modal("hide"),$("#card_state_batch_select_modal").modal("hide")):cs_msg.noti_err(e.ec)},dataType:"json"})}function note_get_status(){$.ajax({url:"/note_get_status",method:"POST",data:{space_seq:space_seq,note_seq:"note_seq"},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}var change_note_info=function(e,t,_,n){$("> #note_btn_group",e).remove(),$("> .info_form",e).remove(),$(".center_noti",e).remove(),v_note_info(t,e,_)},view_note_info=function(e,t,_,n){$("> #note_btn_group",e).remove(),$("> .info_form",e).remove(),v_note_info(t,e,_),1==n?$(".dis:not(.dis_time)",e).each((function(e,t){$(t).attr("disabled","disabled"),$(t).attr("id","")})):$(".dis",e).each((function(e,t){$(t).attr("disabled","disabled"),$(t).attr("id","")})),$("#note_title_edit",e).attr("disabled","disabled").attr("id","")};function note_get_info(e=$("#tabs-note #info_area"),t=change_note_info,_=note.note_seq,n=!0,s=account_list.enum_account_self.self){$.ajax({url:"/note_get_info",method:"POST",data:{space_seq:space_seq,note_seq:_,target_account_seq:s},success:function(s){0==s.ec?t(e,s,_,n):cs_msg.noti_err(s.ec)},dataType:"json"})}var main_note_info_timeline=function(e,t,_){const n=$("#tabs-note #info_area");$(">",n).remove(),v_note_info(e.info,n,t),null!=e.timeline.list_article[0].info_article&&(note.lcl_obj=v_gallery(e.timeline.list_article[0].info_article.file)),v_note_timeline(e.timeline)},view_note_info_timeline=function(e,t,_){const n=$("#card_view_modal #info_area");$(">",n).remove(),v_note_info(e.info,n,t),$("#note_btn_group .dropdown",n).remove(),$("#note_btn_group .btn",n).attr("disabled","disabled"),1==_?$(".dis:not(.dis_time)",n).each((function(e,t){$(t).attr("disabled","disabled"),$(t).attr("id","")})):$(".dis",n).each((function(e,t){$(t).attr("disabled","disabled"),$(t).attr("id","")})),$("#note_title_edit",n).attr("disabled","disabled").attr("id",""),null!=e.timeline.list_article[0].info_article&&v_temp_gallery(e.timeline.list_article[0].info_article.file),v_contents($("#card_view_modal #contents_area"),contents_parser(e.timeline.list_article[0].info_article))};function note_get_info_timeline(e=main_note_info_timeline,t=note.note_seq,_=!0,n=account_list.enum_account_self.self){$.ajax({url:"/note_get_info_timeline",method:"POST",data:{space_seq:space_seq,note_seq:t,target_account_seq:n,limit:0,offset:0},success:function(n){0==n.ec?e(n,t,_):cs_msg.noti_err(n.ec)},dataType:"json"})}function note_get_timeline(e=note.note_seq,t=account_list.enum_account_self.self){$.ajax({url:"/note_get_timeline",method:"POST",data:{space_seq:space_seq,note_seq:e,target_account_seq:t},success:function(e){0==e.ec?(null!=e.list_article[0].info_article&&(note.lcl_obj=v_gallery(e.list_article[0].info_article.file)),v_note_timeline(e)):cs_msg.noti_err(e.ec)},dataType:"json"})}function note_get_temp_timeline(e){$.ajax({url:"/note_get_timeline",method:"POST",data:{space_seq:space_seq,note_seq:e,target_account_seq:account_list.enum_account_self.self},success:function(e){0==e.ec?(null!=e.list_article[0].info_article&&v_temp_gallery(e.list_article[0].info_article.file),v_contents($("#card_view_modal #contents_area"),contents_parser(e.list_article[0].info_article))):cs_msg.noti_err(data.ec)},dataType:"json"})}function note_get_bookmark(){$.ajax({url:"/note_get_bookmark",method:"POST",data:{space_seq:space_seq},success:function(e){0==e.ec?($("#card_bookmark_modal").data("tree_type",tree_data.enum_tree_type.note),v_card_bookmark(e.list_bookmark_info),$("#card_bookmark_modal").modal()):cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_bookmark(e){$.ajax({url:"/note_set_bookmark",method:"POST",data:{space_seq:space_seq,note_seq:e},success:function(e){0==e.ec?note_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function note_del_bookmark(e){$.ajax({url:"/note_del_bookmark",method:"POST",data:{space_seq:space_seq,note_seq:e},success:function(e){0==e.ec?note_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function note_get_schedule(e,t=account_list.enum_account_self.self,_=$("#tabs-note #calendar_depth_btn input").is(":checked"),n=$("#tabs-note #calendar_hidden input").is(":checked"),s=$("#tabs-note select.calendar_state").val()){$.ajax({url:"/note_get_schedule",method:"POST",data:{space_seq:space_seq,target_account_seq:t,note_seq:e,is_all_depth:_,is_include_delete:n,filter_status:s},success:function(e){if(0==e.ec){let t=calendar.set_note_events(e.list_schedule);v_calendar(calendar.note_cal,t);const _=calendar.note_cal.getEventById($("#note_tree").fancytree("getTree").getSelectedNodes()[0].key);null!=_?calendar.note_cal.gotoDate(_.start):calendar.note_cal.today()}else cs_msg.noti_err(e.ec)},dataType:"json"})}function note_set_schedule(e,t,_,n,s,a,o){$.ajax({url:"/note_set_schedule",method:"POST",data:{space_seq:space_seq,note_seq:e,is_repeat:t,is_all_day:_,start_ts:n,end_ts:s,r_rule:a,duration:o},success:function(a){if(0==a.ec){if($("#card_view_modal").hasClass("in")){if(note_get_info($("#card_view_modal #info_area"),view_note_info),init.current_note_sub_tab==init.note_tabs_enum.calendar){let a=calendar.note_cal.getEventById(e),o=moment.unix(n).format(),c=moment.unix(s).format();0!=s&&1==_&&0==t&&(c=moment.unix(s).add(1,"d").format()),a.setDates(o,c,{allDay:_})}}else note_get_info();$("#date_input_modal").modal("hide")}else cs_msg.noti_err(a.ec)},dataType:"json"})}function note_del_schedule(e){cs_msg.swal_select((function(){$.ajax({url:"/note_del_schedule",method:"POST",data:{space_seq:space_seq,note_seq:e},success:function(t){0==t.ec?$("#card_view_modal").hasClass("in")?(note_get_info($("#card_view_modal #info_area"),view_note_info,e),calendar.note_cal.getEventById(e).remove()):note_get_info():cs_msg.noti_err(t.ec)},dataType:"json"})}))}