function card_set_title(e,_){""!=e&&$.ajax({url:"/card_set_title",method:"POST",data:{space_seq:space_seq,card_seq:_,title:e},success:function(_){0==_.ec?(card_detail.card_title=e,card_get_info()):cs_msg.noti_err(_.ec)},dataType:"json"})}var main_card_info=function(e,_,t){const c=$("#tabs-tree #info_area");card_detail.set_card_info(e),$("> #card_btn_group",c).remove(),$("> .info_form",c).remove(),$(".center_noti",c).remove(),v_info(e,c,_),v_link(e,$(".info_collapse",c)),v_confirm_list(e.list_confirm,$(".info_collapse",c)),info_btn_control(e,c),info_controll(e,c,card_detail.card_node.isTopLevel())},view_card_info=function(e,_,t){const c=$("#card_view_modal #info_area");$(">",c).remove(),v_info(e,c,_),info_btn_control(e,c),set_auth_select($("#owner_select",c),e.owner_account_seq,!1),set_auth_select($("#viewer_select",c),e.list_viewer_account_seq,!0),$("#card_btn_group .dropdown",c).remove(),$("#card_btn_group #card_create_btn",c).remove(),$("#per_done_combobox",c).remove(),1==t?$(".dis:not(.dis_time)",c).each((function(e,_){$(_).attr("disabled","disabled"),$(_).attr("id","")})):$(".dis",c).each((function(e,_){$(_).attr("disabled","disabled"),$(_).attr("id","")})),$("#card_title_edit",c).attr("disabled","disabled").attr("id",""),card_get_temp_contents(_)},todo_card_info=function(e,_,t){const c=$("#todo_split_right");$("> #card_btn_group",c).remove(),$("> .info_form",c).remove(),v_info(e,c,_),info_btn_control(e,c),info_controll(e,c,$("#tree").fancytree("getTree").getNodeByKey(_.toString()).isTopLevel(),"todo"),$("#card_btn_group .dropdown",c).remove(),$("#card_btn_group .card_create_btn",c).remove(),$("#todo_split_right #card_btn_group").append('<div id="go_card" class="btn btn-success btn-sm pull-right"><i class="fas fa-external-link-square-alt fa-lg"></i></div>')};function card_get_info(e=main_card_info,_=card_detail.card_seq,t=!0,c=0){$.ajax({url:"/card_get_info",method:"POST",sync:!1,data:{space_seq:space_seq,card_seq:_,target_account_seq:c},success:function(c){0==c.ec?e(c,_,t):cs_msg.noti_err(c.ec)},dataType:"json"})}var main_card_info_timeline=function(e,_,t,c){card_detail.set_card_info(_.info),$(">",e).remove(),v_info(_.info,e,_.card_seq),v_link(_.info,$(".info_collapse",e)),info_btn_control(_.info,e),info_controll(_.info,e,card_detail.card_node.isTopLevel()),$(".info_collapse",e).addClass("border_bottom mb_10"),null!=_.timeline.list_article[0].info_article&&(card_detail.lcl_obj=v_gallery(_.timeline.list_article[0].info_article.file)),card_detail.set_card_data(_.timeline),contents_data.set_contents_seq(_.timeline.list_article[0].article_seq),v_card_timeline(_.timeline)},view_card_info_timeline=function(e,_,t,c){$(">",e).remove(),v_info(_.info,e,_.card_seq),info_btn_control(_.info,e),$(".info_collapse",e).addClass("border_bottom mb_10"),set_auth_select($("#owner_select",e),_.info.owner_account_seq,!1),set_auth_select($("#viewer_select",e),_.info.list_viewer_account_seq,!0),$("#card_btn_group .dropdown",e).remove(),$("#card_btn_group #card_create_btn",e).remove(),$("#per_done_combobox",e).remove(),1==c?$(".dis:not(.dis_time)",e).each((function(e,_){$(_).attr("disabled","disabled"),$(_).attr("id","")})):$(".dis",e).each((function(e,_){$(_).attr("disabled","disabled"),$(_).attr("id","")})),$("#card_title_edit",e).attr("disabled","disabled").attr("id",""),card_detail.set_card_data(_.timeline),null!=_.timeline.list_article[0].info_article&&v_temp_gallery(_.timeline.list_article[0].info_article.file),v_contents($("#card_view_modal #contents_area"),contents_parser(_.timeline.list_article[0].info_article))},view_todo_info_timeline=function(e,_,t,c){$(">",e).remove(),todo.todo_card_seq=_.card_seq,todo.todo_data=_.info,v_info(_.info,e,_.card_seq),info_btn_control(_.info,e),info_controll(_.info,e,!1,"todo"),$(".info_collapse",e).addClass("border_bottom mb_10"),$("#card_btn_group .dropdown",e).remove(),$("#card_btn_group #card_create_btn",e).remove(),card_detail.set_card_data(_.timeline),null!=_.timeline.list_article[0].info_article&&v_temp_gallery(_.timeline.list_article[0].info_article.file),$(e).append('<div id="contents_area"></div>'),v_contents($("#contents_area",e),contents_parser(_.timeline.list_article[0].info_article)),$("#todo_split_right #card_btn_group").append('<div id="go_card" class="btn btn-success btn-sm pull-right"><i class="fas fa-external-link-square-alt fa-lg"></i></div>')};function card_get_info_timeline(e,_=init.info_time_type_enum.card,t=main_card_info_timeline,c=card_detail.card_seq,a=null,s=!0,r=account_list.enum_account_self.self){$.ajax({url:"/card_get_info_timeline",method:"POST",data:{space_seq:space_seq,use_seq:c,type_use:_,sub_seq:a,target_account_seq:r,limit:0,offset:0},success:function(_){0==_.ec?t(e,_,c,s):cs_msg.noti_err(_.ec)},dataType:"json"})}function card_del_remove(e=card_detail.card_seq){cs_msg.swal_select((function(){$.ajax({url:"/card_del_remove",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(_){0==_.ec||(61==_.ec?cs_msg.swal_select((function(){$.ajax({url:"/card_del_remove",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}),"force","force ex","force comp"):cs_msg.noti_err(_.ec))},dataType:"json"})}))}function card_set_recover(e=card_detail.card_seq){$.ajax({url:"/card_set_recover",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function card_set_lock(e=card_detail.card_seq,_=$("#card_set_lock_btn").hasClass("uncheck")){$.ajax({url:"/card_set_lock",method:"POST",data:{space_seq:space_seq,card_seq:e,is_lock:_},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function card_set_todo(e=card_detail.card_seq,_=main_card_info,t=$("#card_set_todo_btn").hasClass("uncheck"),c=0){$.ajax({url:"/card_set_todo",method:"POST",data:{space_seq:space_seq,card_seq:e,is_set:t,target_account_seq:c},success:function(t){0==t.ec?card_get_info(_,e):cs_msg.noti_err(t.ec)},dataType:"json"})}function card_set_hidden(e=card_detail.card_seq,_=card_detail.info.is_hidden){$.ajax({url:"/card_set_hidden",method:"POST",data:{space_seq:space_seq,card_seq:e,is_hidden:!_},success:function(t){0==t.ec?card_get_info():61==t.ec?cs_msg.swal_select((function(){$.ajax({url:"/card_set_hidden",method:"POST",data:{space_seq:space_seq,card_seq:e,is_hidden:!_},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}),"force","force ex","force comp"):cs_msg.noti_err(t.ec)},dataType:"json"})}function card_get_bookmark(){$.ajax({url:"/card_get_bookmark",method:"POST",data:{space_seq:space_seq,card_seq:card_detail.card_seq},success:function(e){0==e.ec?($("#card_bookmark_modal").data("tree_type",tree_data.enum_tree_type.card),v_card_bookmark(e.list_bookmark_info),$("#card_bookmark_modal").modal()):cs_msg.noti_err(e.ec)},dataType:"json"})}function card_set_bookmark(e=0){$.ajax({url:"/card_set_bookmark",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(_){0==_.ec?$("#card_view_modal").hasClass("in")?card_get_info(view_card_info,e):card_get_info():cs_msg.noti_err(_.ec)},dataType:"json"})}function card_del_bookmark(e=0){$.ajax({url:"/card_del_bookmark",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(_){0==_.ec?$("#card_view_modal").hasClass("in")?card_get_info(view_card_info,e):card_get_info():cs_msg.noti_err(_.ec)},dataType:"json"})}function card_set_status(e,_=card_detail.card_seq){$.ajax({url:"/card_set_status",method:"POST",data:{space_seq:space_seq,card_seq:_,status:e},success:function(t){0==t.ec?card_get_info():61==t.ec?cs_msg.swal_select((function(){$.ajax({url:"/card_set_status",method:"POST",data:{space_seq:space_seq,card_seq:_,status:e},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}),"force","force ex","force comp"):(card_get_info(),cs_msg.noti_err(t.ec))},dataType:"json"})}function card_set_create(e,_,t,c=!1,a=!1,s=0,r=0,o="",n=0,i=!1){""!=(t=t.trim())&&$.ajax({url:"/card_set_create",method:"POST",async:!1,data:{space_seq:space_seq,pcard_seq:_,title:t,is_schedule:i,owner_account_seq:account_list.enum_account_self.self,is_repeat:c,is_all_day:a,start_ts:s,end_ts:r,r_rule:o,duration:n},success:function(_){0==_.ec?(e.val(""),tree_data.create_key=_.card_seq,1==i&&card_get_schedule_json()):cs_msg.noti_err(_.ec)},dataType:"json"})}function card_set_move(e,_){$.ajax({url:"/card_set_move",method:"POST",data:{space_seq:space_seq,src_seq:e,dst_seq:_},success:function(e){0==e.ec?$("#card_move_modal").modal("hide"):cs_msg.noti_err(e.ec)},dataType:"json"})}function card_set_priority(e,_=card_detail.card_seq){$.ajax({url:"/card_set_priority",method:"POST",data:{space_seq:space_seq,card_seq:_,priority:e},success:function(e){0==e.ec||cs_msg.noti_err(e.ec),card_get_info()},dataType:"json"})}function card_set_account_owner(e,_=card_detail.card_seq,t){$.ajax({url:"/card_set_account_owner",method:"POST",data:{space_seq:space_seq,card_seq:_,owner_account_seq:e,note:t},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},error:function(e,_,t){},dataType:"json"})}function card_set_account_viewer(e,_=card_detail.card_seq){$.ajax({url:"/card_set_account_viewer",method:"POST",data:{space_seq:space_seq,card_seq:_,list_viewer_account_seq:e},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},error:function(e,_,t){},dataType:"json"})}function card_get_account_owner_flow(e=card_detail.card_seq){$.ajax({url:"/card_get_account_owner_flow",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(e){0==e.ec?v_owner_flow(e.owner_flow):cs_msg.noti_err(e.ec)},error:function(e,_,t){},dataType:"json"})}function card_set_per_done(e,_=card_detail.card_seq){$.ajax({url:"/card_set_per_done",method:"POST",data:{space_seq:space_seq,card_seq:_,per_done:e},success:function(_){0==_.ec?$("#tabs-card-info .progress-bar").css("width",e+"%").text(e+"%"):cs_msg.noti_err(_.ec)},error:function(e,_,t){},dataType:"json"})}function card_get_timeline(e=0,_=card_detail.card_seq,t=account_list.enum_account_self.self){$.ajax({url:"/card_get_timeline",method:"POST",data:{space_seq:space_seq,card_seq:_,target_account_seq:t},success:function(e){0==e.ec?(null!=e.list_article[0].info_article&&(card_detail.lcl_obj=v_gallery(e.list_article[0].info_article.file,card_detail)),card_detail.set_card_data(e),contents_data.set_contents_seq(e.list_article[0].article_seq),v_card_timeline(e)):cs_msg.noti_err(e.ec)},dataType:"json"})}function card_get_temp_contents(e,_=account_list.enum_account_self.self){$.ajax({url:"/card_get_timeline",method:"POST",data:{space_seq:space_seq,card_seq:e,target_account_seq:_},success:function(e){0==e.ec?(card_detail.set_card_data(e),null!=e.list_article[0].info_article&&v_temp_gallery(e.list_article[0].info_article.file),v_contents($("#card_view_modal #contents_area"),contents_parser(e.list_article[0].info_article))):cs_msg.noti_err(data.ec)},dataType:"json"})}var main_card_list=function(e){card_detail.set_card_list(e),v_card_list(e.list_card_info)};function get_card_list(e=main_card_list,_=card_detail.card_seq,t=$("#card_list_hidden input:first").is(":checked"),c=$("#card_list_hidden input:last").is(":checked"),a=$("#card_list_select select.select_auth").val(),s=$("#card_list_select select.select_state").val(),r=0){$.ajax({url:"/get_card_list",method:"POST",data:{space_seq:space_seq,card_seq:_,is_hidden:t,is_all_depth:c,filter_type_auth:a,filter_status:s,target_account_seq:r},success:function(_){0==_.ec?e(_):cs_msg.noti_err(_.ec)},dataType:"json"})}var main_card_file_list=function(e){card_detail.set_file_list(e),v_file_list()};function get_card_file_list(e=main_card_file_list,_=card_detail.card_seq){$.ajax({url:"/get_card_file",method:"POST",data:{space_seq:space_seq,card_seq:_,is_include_under:$("#include_under_btn input").is(":checked"),filter_type:$("select.select_pos").val(),type_preview:2,target_account_seq:account_list.enum_account_self.self},success:function(_){0==_.ec?(e(_),null!=_.list_file_info&&(card_detail.lcl_obj=v_gallery(_.list_file_info))):cs_msg.noti_err(_.ec)},dataType:"json"})}function cost_card_seq(){if($("#card_view_modal").hasClass("in"))return card_detail.temp_card_seq;switch(init.current_main_tab){case init.main_tabs_enum.tree:return card_detail.card_seq;case init.main_tabs_enum.todo:return todo.todo_card_seq}}function set_cost_insert(e,_){$.ajax({url:"/set_cost_insert",method:"POST",data:{space_seq:space_seq,card_seq:cost_card_seq(),cost_time:e,note:_},success:function(e){0==e.ec?get_cost_list(cost_card_seq()):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_cost_update(e,_,t){$.ajax({url:"/set_cost_update",method:"POST",data:{space_seq:space_seq,card_cost_seq:e,cost_time:_,note:t},success:function(e){0==e.ec?get_cost_list(cost_card_seq()):cs_msg.noti_err(e.ec)},dataType:"json"})}function del_cost(e){cs_msg.swal_select((function(){$.ajax({url:"/del_cost",method:"POST",data:{space_seq:space_seq,card_cost_seq:e},success:function(e){0==e.ec?get_cost_list(cost_card_seq()):cs_msg.noti_err(e.ec)},dataType:"json"})}))}function get_cost_list(e=card_detail.card_seq){$.ajax({url:"/get_cost_list",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(_){0==_.ec?v_card_cost(_,e):cs_msg.noti_err(_.ec)},dataType:"json"})}function get_cost_view(e=card_detail.card_seq){$.ajax({url:"/get_cost_list",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(e){0==e.ec?v_card_cost_view(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_cost_list_depth1(e=card_detail.card_seq){$.ajax({url:"/get_cost_list_depth1",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(e){0==e.ec?v_cost_list(e.list_cost_log_1depth):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_link(e,_){$.ajax({url:"/set_link",method:"POST",data:{space_seq:space_seq,card_seq:card_detail.card_seq,target_card_seq:e,relation:_},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}function get_link_list(){$.ajax({url:"/get_link_list",method:"POST",data:{space_seq:space_seq,card_seq:card_detail.card_seq},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function del_link(e,_){cs_msg.swal_select((function(){$.ajax({url:"/del_link",method:"POST",data:{space_seq:space_seq,card_seq:_,card_link_seq:e},success:function(e){0==e.ec?card_get_info():cs_msg.noti_err(e.ec)},dataType:"json"})}))}function get_link_timeline(e,_,t){$.ajax({url:"/get_link_timeline",method:"POST",data:{space_seq:space_seq,card_seq:e,link_seq:_},success:function(_){0==_.ec?($("#card_link_contents_modal #contents_title_area h3").remove(),$("#card_link_contents_modal #contents_title_area").append(`<h3 class="text-center over_wrapper">${t}</h3>`),$("#card_link_contents_modal #contents_edit_area >").remove(),1==_.is_accessable?($("#card_link_contents_modal #go_card").removeClass("hidden"),$("#card_link_contents_modal #go_card").data("card_seq",e)):($("#card_link_contents_modal #go_card").addClass("hidden"),$("#card_link_contents_modal #go_card").data("card_seq",0)),null!=_.list_article[0].info_article&&v_temp_gallery(_.list_article[0].info_article.file),v_contents($("#card_link_contents_modal #contents_edit_area"),contents_parser(_.list_article[0].info_article))):cs_msg.noti_err(_.ec)},dataType:"json"})}function card_get_log(e=$("#tabs-card-log #log_list"),_=card_detail.card_seq,t=$("#log_depth_btn input:first").is(":checked"),c=0,a=!1,s=6){$.ajax({url:"/card_get_log",method:"POST",data:{space_seq:space_seq,card_seq:_,is_include_under:t,zlog_seq:c,count:s,target_account_seq:account_list.enum_account_self.self},success:function(_){0==_.ec?(0==a&&$(">",e).remove(),v_log(_.list_log_info,e)):cs_msg.noti_err(_.ec)},dataType:"json"})}function card_get_cost_view_user_list(){$.ajax({url:"/card_get_cost_view_user_list",method:"POST",data:{space_seq:space_seq,card_seq:card_detail.card_seq},success:function(e){0==e.ec?v_cost_view_user_list(e.list_cost_view_user):cs_msg.noti_err(e.ec)},dataType:"json"})}function card_get_cost_view_user_card_list(e){$.ajax({url:"/card_get_cost_view_user_card_list",method:"POST",data:{space_seq:space_seq,card_seq:card_detail.card_seq,account_seq:e},success:function(e){0==e.ec?v_user_cost_list(e.list_cost_view_user_card):cs_msg.noti_err(e.ec)},dataType:"json"})}function card_get_cost_view_log_cost_list(e=0,_=!1,t=0){$.ajax({url:"/card_get_cost_view_log_cost_list",method:"POST",data:{space_seq:space_seq,card_seq:card_detail.card_seq,account_seq:0,limit:e+20,offset:e},success:function(e){0==e.ec?v_cost_log_list(e,_):cs_msg.noti_err(e.ec)},dataType:"json"})}