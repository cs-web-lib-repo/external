function card_set_schedule(e,a,t,c,s,n,_){$.ajax({url:"/card_set_schedule",method:"POST",data:{space_seq:space_seq,card_seq:e,is_repeat:a,is_all_day:t,start_ts:c,end_ts:s,r_rule:n,duration:_},success:function(n){if(0==n.ec){if($("#card_view_modal").hasClass("in")){if(card_get_info_timeline($("#card_view_modal #info_area"),init.info_time_type_enum.card,view_card_info_timeline,e),init.current_sub_tab==init.card_tabs_enum.calendar){let n=calendar.card_cal.getEventById(e),_=moment.unix(c).format(),l=moment.unix(s).format();0!=s&&1==t&&0==a&&(l=moment.unix(s).add(1,"d").format()),n.setDates(_,l,{allDay:t})}}else init.current_sub_tab==init.card_tabs_enum.info&&card_get_info();$("#date_input_modal").modal("hide")}else cs_msg.noti_err(n.ec)},dataType:"json"})}function main_calendar_v(e,a){v_calendar(e,calendar.set_events(a.list_schedule));const t=calendar.card_cal.getEventById($("#tree").fancytree("getTree").getSelectedNodes()[0].key);null!=t?calendar.card_cal.gotoDate(t.start):e.today()}function card_get_schedule_json(e=main_calendar_v,a=calendar.card_cal,t=card_detail.card_seq,c=account_list.enum_account_self.self,s=$("#tabs-tree #calendar_depth_btn input").is(":checked"),n=$("#tabs-tree #calendar_hidden input").is(":checked"),_=$("#tabs-tree #calendar_hidden input").is(":checked"),l=!1,r=!1,d=$("#tabs-tree select.calendar_state").val()){$.ajax({url:"/card_get_schedule",method:"POST",data:{space_seq:space_seq,card_seq:t,target_account_seq:c,is_all_depth:s,is_include_hidden:n,is_include_delete:_,is_target_account_seq_owner_only:l,is_force_editable_false:r,filter_status:d},success:function(t){0==t.ec?e(a,t):cs_msg.noti_err(t.ec)},dataType:"json"})}function card_del_schedule(e){cs_msg.swal_select((function(){$.ajax({url:"/card_del_schedule",method:"POST",data:{space_seq:space_seq,card_seq:e},success:function(a){0==a.ec?$("#card_view_modal").hasClass("in")?(card_get_info(view_card_info,e),calendar.card_cal.getEventById(e).remove()):card_get_info():cs_msg.noti_err(a.ec)},dataType:"json"})}))}function get_calendar_list(){$.ajax({url:"/get_calendar_list",method:"POST",data:{space_seq:space_seq},success:function(e){0==e.ec?(WebuiPopovers.hideAll(),v_calendar_list(e.list_calendar),v_cal_checked(calendar.get_cal_check_list()),v_calendar_set_list(e.list_calendar),v_cal_select($("#event_create_modal .cal_select"),e.list_calendar),v_cal_select($("#event_edit_modal .cal_select"),e.list_calendar)):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_sort_calendar_list(){$.ajax({url:"/get_calendar_list",method:"POST",data:{space_seq:space_seq},success:function(e){0==e.ec?v_cal_sort_list(e.list_calendar):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_calendar_trashList(){$.ajax({url:"/get_calendar_trashList",method:"POST",data:{space_seq:space_seq},success:function(e){0==e.ec?v_trash_list(e.list_calendar):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_calendar_info(e,a=!0){$.ajax({url:"/get_calendar_info",method:"POST",data:{space_seq:space_seq,calendar_seq:e},success:function(t){0==t.ec?1==a?(v_cal_set(t,$("#calendar_setting_modal .modal-body")),$("#calendar_setting_modal #cal_update_btn").data("cal_seq",t.info.calendar_seq[0]),$("#calendar_setting_modal").modal()):($("#calendar_set_contents >").remove(),$("#calendar_set_contents").append(`<div id="set_area">\n\x3c!--<h4 data-i18n="calendar:cal set.title"></h4>--\x3e\n\x3c!--<input class="form-control input-sm cal_title_input" data-i18n="[placeholder]calendar:cal set.title" placeholder="" maxlength="100">--\x3e\n\x3c!--<hr class="mb_30">--\x3e\n\x3c!--<h4 data-i18n="calendar:cal set.comment"></h4>--\x3e\n\x3c!--<textarea id="cal_note_input" type="text"--\x3e\n\x3c!--class="confirm_note_input form-control h_15vh"--\x3e\n\x3c!--maxlength="5000"--\x3e\n\x3c!--data-i18n="[placeholder]calendar:cal set.comment"></textarea>--\x3e\n\x3c!----\x3e\n\x3c!--<hr class="mb_30">--\x3e\n\x3c!--<h4 data-i18n="calendar:cal set.color"></h4>--\x3e\n\x3c!--<input id="set_cal_color">--\x3e\n\x3c!--<hr class="mb_30">--\x3e\n\x3c!--<h4 data-i18n="calendar:cal set.lock"></h4>--\x3e\n\x3c!--<div id="cal_lock_btn" class="btn btn-default btn-warning"></div>--\x3e\n\x3c!--<hr class="mb_30">--\x3e\n</div>\n<h4 data-i18n="calendar:cal set.share"></h4>\n<div id="member_area" class="list-group"></div>\n<div class="center_flex mb_30">\n<div id="account_add_btn" class="btn btn-default btn-large-dim">\n<i class="fas fa-users-cog fa-lg"></i>\n<span data-i18n="calendar:cal set.manage account"></span>\n</div>\n</div>\n<div id="cal_update_btn" class="btn btn-primary" data-cal_seq="${e}">\n<span data-i18n="calendar:cal set.apply"></span>\n</div>`),v_cal_set(t,$("#calendar_set_contents #set_area")),v_cal_share(t.list_member,$("#calendar_set_contents #member_area")),split_collapse(init.calendar_set_split,0)):cs_msg.noti_err(t.ec)},dataType:"json"})}function set_calendar_create(e){$.ajax({url:"/set_calendar_create",method:"POST",data:{space_seq:space_seq,name:e},success:function(e){0==e.ec?($("#calendar_create_modal input").val(""),$("#calendar_create_modal").modal("hide")):cs_msg.noti_err(e.ec)},dataType:"json"})}function del_calendar_remove(e,a=!1){cs_msg.swal_select((function(){$.ajax({url:"/del_calendar_remove",method:"POST",data:{space_seq:space_seq,calendar_seq:e},success:function(e){0==e.ec?1==a&&get_calendar_trashList():cs_msg.noti_err(e.ec)},dataType:"json"})}))}function set_calendar_recover(e){$.ajax({url:"/set_calendar_recover",method:"POST",data:{space_seq:space_seq,calendar_seq:e},success:function(e){0==e.ec?get_calendar_trashList():cs_msg.noti_err(e.ec)},dataType:"json"})}function get_calendar_member(e){$.ajax({url:"/get_calendar_member",method:"POST",data:{space_seq:space_seq,calendar_seq:e},success:function(a){0==a.ec?(v_cal_share(a.list_member,$("#calendar_share_modal .list-group")),$("#calendar_share_modal").data("cal_seq",e).modal()):cs_msg.noti_err(a.ec)},dataType:"json"})}function set_calendar_member(e,a,t){$.ajax({url:"/set_calendar_member",method:"POST",data:{space_seq:space_seq,calendar_seq:e,account_seq:a,type_access:t},success:function(e){0==e.ec?$("#calendar_share_modal").modal("hide"):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_calendar_member_leave(e){cs_msg.swal_select((function(){$.ajax({url:"/set_calendar_member_leave",method:"POST",data:{space_seq:space_seq,calendar_seq:e},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}),"leave?")}function set_calendar_update(e,a=null,t=null,c=null,s=null,n=null,_=null,l=null,r=null,d=null,i=null){$.ajax({url:"/set_calendar_update",method:"POST",data:{space_seq:space_seq,calendar_seq:a,name:t,note:c,is_lock:s,type_public:n,is_deadline:_,start_time:l,end_time:r,account_seq:d,type_access:i},success:function(a){0==a.ec?e():cs_msg.noti_err(a.ec)},dataType:"json"})}function set_member_calendar_order(e,a){$.ajax({url:"/set_member_calendar_order",method:"POST",data:{space_seq:space_seq,calendar_seq:e,front_calendar_seq:a},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function set_member_calendar_custom_color(e,a){$.ajax({url:"/set_member_calendar_custom_color",method:"POST",data:{space_seq:space_seq,calendar_seq:e,color:a},success:function(e){0==e.ec?(WebuiPopovers.hideAll(),get_event_list()):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_event_list(){0!=calendar.get_cal_check_list().length?$.ajax({url:"/get_event_list",method:"POST",data:{space_seq:space_seq,calendar_seq:calendar.get_cal_check_list(),start_date:moment(calendar.cal.currentData.dateProfile.activeRange.start).unix(),end_date:moment(calendar.cal.currentData.dateProfile.activeRange.end).unix()},success:function(e){0==e.ec?v_calendar(calendar.cal,calendar.set_main_cal_events(e.list_event_summary)):cs_msg.noti_err(e.ec)},dataType:"json"}):v_calendar(calendar.cal,[])}function get_event_item(e){$.ajax({url:"/get_event_item",method:"POST",data:{space_seq:space_seq,calendar_event_seq:e},success:function(e){if(0==e.ec){let a=moment(calendar.cal.currentData.dateProfile.activeRange.start).unix(),t=moment(calendar.cal.currentData.dateProfile.activeRange.end).unix(),c=e.list_event_summary.list_schedule.start_ts[0],s=e.list_event_summary.list_schedule.end_ts[0],n=calendar.cal.getEventById(e.list_event_summary.calendar_event_seq[0]);if(null!=n&&n.remove(),a<=c<=t||a<=s<=t){let a=calendar.set_main_cal_events(e.list_event_summary)[0];calendar.cal.addEvent(a)}}else cs_msg.noti_err(e.ec)},dataType:"json"})}function get_pop_event_info(e){$.ajax({url:"/get_event_info",method:"POST",data:{space_seq:space_seq,calendar_event_seq:e.event.extendedProps.event_seq,type_preview:init.enum_preview_size.w100},success:function(a){0==a.ec?v_event_popover_view(a.info,e):cs_msg.noti_err(a.ec)},dataType:"json"})}function get_edit_event_info(e,a){$.ajax({url:"/get_event_info",method:"POST",data:{space_seq:space_seq,calendar_event_seq:e,type_preview:init.enum_preview_size.w100},success:function(e){0==e.ec?v_event_edit_view(e.info,a):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_event_create(e,a="",t="",c=[],s=!0,n,_,l=!1,r="",d=""){$.ajax({url:"/set_event_create",method:"POST",data:{space_seq:space_seq,calendar_seq:e,is_repeat:l,is_all_day:s,start_ts:n,end_ts:_,r_rule:r,duration:d,title:a,note:t,file_seq:c},success:function(e){0==e.ec?$("#event_create_modal").modal("hide"):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_event_update(e,a=null,t=null,c=null,s=null,n=null,_=null,l=null){$.ajax({url:"/set_event_update",method:"POST",data:{space_seq:space_seq,calendar_event_seq:e,calendar_seq:l,title:a,note:t,start_ts:c,end_ts:s,is_all_day:n,is_repeat:!1,r_rule:"",duration:0,file_seq:_},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function del_event_remove(e,a=!1){cs_msg.swal_select((function(){$.ajax({url:"/del_event_remove",method:"POST",data:{space_seq:space_seq,calendar_event_seq:e},success:function(e){0==e.ec?1==a&&get_calendar_trash_event_list($("#event_trash_list").data("cal_seq"),$("#calendar_set_contents")):cs_msg.noti_err(e.ec)},dataType:"json"})}))}function get_calendar_trash_info(){$("#log").append(`<h4>${arguments.callee.name}`),$.ajax({url:"/get_calendar_trash_info",method:"POST",data:{space_seq:space_seq,calendar_seq:cal_seq},success:function(e){0==e.ec||cs_msg.noti_err(e.ec)},dataType:"json"})}function get_calendar_trash_event_list(e,a){$.ajax({url:"/get_calendar_trash_event_list",method:"POST",data:{space_seq:space_seq,calendar_seq:e,limit:0,offset:0},success:function(t){0==t.ec?(v_event_trash_list(t.list_event_summary,e,a),split_collapse(init.calendar_set_split,0)):cs_msg.noti_err(t.ec)},dataType:"json"})}function set_calendar_trash_event_recover(e){$.ajax({url:"/set_calendar_trash_event_recover",method:"POST",data:{space_seq:space_seq,calendar_event_seq:e},success:function(e){0==e.ec?get_calendar_trash_event_list($("#event_trash_list").data("cal_seq"),$("#calendar_set_contents")):cs_msg.noti_err(e.ec)},dataType:"json"})}function del_calendar_trash_clear(e){cs_msg.swal_select((function(){$.ajax({url:"/del_calendar_trash_clear",method:"POST",data:{space_seq:space_seq,calendar_seq:e},success:function(a){0==a.ec?get_calendar_trash_event_list(e,$("#calendar_set_contents")):cs_msg.noti_err(a.ec)},dataType:"json"})}))}