function set_org_tree_data(){if($("#morg_tree").length){let e=$("#morg_tree").fancytree("getTree");org_data.morg_active_key=e.getActiveNode(),org_data.morg_select_key=e.getSelectedNodes()[0],org_data.morg_expand_list=[],org_data.morg_scroll_top=$("#"+$("#morg_tree").fancytree("getTree").rootNode.ul.id).scrollTop(),null!=org_data.morg_active_key&&(org_data.morg_active_pkey=e.getActiveNode().parent),e.visit((function(e){1==e.isExpanded()&&org_data.morg_expand_list.push(e.key)}))}}function org_tree_reload(e){const t=make_map(e,"org_seq","porg_seq");let a=make_group_tree(e,t,1);if(-1==e.org_seq[0]){let t=new Object;t.depth=e.depth[0],t.title=i18next.t("tree:org_tree.other users"),t.key=e.org_seq[0],t.porg_seq=e.porg_seq[0],t.v_account_seq=e.json__account_seq[0],t.is_account=!1,t.folder=!0;let o=!1,_=new Array;e.json__admin_account_seq[0].forEach((function(e){e!=account_list.account.account_seq||(o=!0)})),e.json__account_seq[0].forEach((function(t){let a=account_list.get_account(t),r=!1;e.json__admin_account_seq[0].forEach((function(e){e!=t||(r=!0)})),_.push({key:"a"+t,title:a.name,folder:!1,data:{url:a.photo_url,account_seq:t,is_account:!0,admin_seq:e.json__admin_account_seq[0],is_admin:r,is_member:o}})})),t.children=_,a=[a,t]}set_org_tree_data(),$("#morg_tree").length&&$("#morg_tree").fancytree("getTree").reload(a),$("#org_tree").fancytree("getTree").reload(a)}function org_mgt_tree_reload(e){let t=$("#org_mgt_tree").fancytree("getTree");t.clear(),e.v_admin_org_seq.forEach((function(e){t.rootNode.addChildren($("#org_tree").fancytree("getTree").getNodeByKey(e.toString()).toDict(!0))}))}function set_unselected(e){for(let t in e.children)set_unselected(e.children[t]);1==e.folder&&(e.unselectableStatus=!1)}function select_tree_reload(){let e=$(".select_modal #single_select_tree").fancytree("getTree"),t=$(".select_modal #multi_select_tree").fancytree("getTree"),a=$("#org_member_tree").fancytree("getTree");e.clear(),t.clear(),a.clear();let o=$("#org_tree").fancytree("getTree").toDict(!1);t.rootNode.addChildren(o),a.rootNode.addChildren(o),set_unselected(o[0]),e.rootNode.addChildren(o)}function get_org(){$.ajax({url:"/get_org",method:"POST",async:!1,data:{space_seq:space_seq},success:function(e){0==e.ec?(org_data.set_admin_data(e.v_admin_org_seq),e.info.json__account_seq=JSON.parse(e.info.json__account_seq),e.info.json__admin_account_seq=JSON.parse(e.info.json__admin_account_seq),org_tree_reload(e.info),org_mgt_tree_reload(e),select_tree_reload()):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_info_account(e,t){$.ajax({url:"/get_info_account",method:"POST",async:!1,data:{space_seq:space_seq,account_seq:e},success:function(e){0==e.ec?v_org_account(e,t):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_org_create(e,t){$.ajax({url:"/set_org_create",method:"POST",data:{space_seq:space_seq,porg_seq:e,name:t},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_org_move(e,t){$.ajax({url:"/set_org_move",method:"POST",data:{space_seq:space_seq,src_org_seq:e,dst_org_seq:t},success:function(e){0==e.ec?$("#morg_move_modal").modal("hide"):cs_msg.noti_err(e.ec)},dataType:"json"})}function del_org_remove(e){cs_msg.swal_select((function(){$.ajax({url:"/del_org_remove",method:"POST",data:{space_seq:space_seq,org_seq:e},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}))}function set_org_modify(e,t){$.ajax({url:"/set_org_modify",method:"POST",data:{space_seq:space_seq,org_seq:e,name:t},success:function(e){0==e.ec?$("#org_modify_modal").modal("hide"):cs_msg.noti_err(e.ec)},dataType:"json"})}function org_account_add(e){$.ajax({url:"/set_account_add",method:"POST",data:{space_seq:space_seq,org_seq:$("#morg_tree").fancytree("getTree").getActiveNode().key,list_account_seq:e},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function org_account_move(e){$.ajax({url:"/set_account_move",method:"POST",data:{space_seq:space_seq,org_seq:$("#morg_tree").fancytree("getTree").getActiveNode().key,list_account_seq:e},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function org_account_remove(e){$.ajax({url:"/del_account_remove",method:"POST",data:{space_seq:space_seq,org_seq:$("#morg_tree").fancytree("getTree").getActiveNode().parent.key,list_account_seq:[e]},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function get_admin(e){$.ajax({url:"/get_admin",method:"POST",data:{space_seq:space_seq},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function set_admin(e,t){$.ajax({url:"/org_set_admin",method:"POST",data:{space_seq:space_seq,org_seq:$("#morg_tree").fancytree("getTree").getActiveNode().parent.key,account_seq:e,is_admin:t},success:function(e){0==e.ec?console.log(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function org_get_card(e){$.ajax({url:"/org_get_card",method:"POST",data:{space_seq:space_seq,v_account_seq:e},beforeSend:function(){if(0==e.length){if(org_data.org_tab==org_data.org_tabs_enum.all)return org_data.all_card_table.clear(),org_data.all_card_table.state.clear(),org_data.all_card_table.draw(),!1;if(org_data.org_tab==org_data.org_tabs_enum.mgt)return org_data.mgt_card_table.clear(),org_data.mgt_card_table.state.clear(),org_data.mgt_card_table.draw(),!1}},success:function(e){0==e.ec?org_data.org_tab==org_data.org_tabs_enum.all?v_org_card(org_data.all_card_table,e.list_card,$("#org_all_card")):v_org_card(org_data.mgt_card_table,e.list_card,$("#org_mgt_card")):cs_msg.noti_err(e.ec)},dataType:"json"})}function org_get_todo(e){$.ajax({url:"/org_get_todo",method:"POST",data:{space_seq:space_seq,v_account_seq:e},beforeSend:function(){if(0==e.length){if(org_data.org_tab==org_data.org_tabs_enum.all)return org_data.all_todo_table.clear(),org_data.all_todo_table.state.clear(),org_data.all_todo_table.draw(),!1;if(org_data.org_tab==org_data.org_tabs_enum.mgt)return org_data.mgt_todo_table.clear(),org_data.mgt_todo_table.state.clear(),org_data.mgt_todo_table.draw(),!1}},success:function(e){0==e.ec?org_data.org_tab==org_data.org_tabs_enum.all?v_org_todo(org_data.all_todo_table,e.list_todo,$("#org_all_todo")):v_org_todo(org_data.mgt_todo_table,e.list_todo,$("#org_mgt_todo")):cs_msg.noti_err(e.ec)},dataType:"json"})}function org_get_schedule(e,t){$.ajax({url:"/org_get_schedule",method:"POST",data:{space_seq:space_seq,v_account_seq:e},beforeSend:function(){if(0==e.length){if(org_data.org_tab==org_data.org_tabs_enum.all)return v_calendar(calendar.cal_org_all,[]),!1;if(org_data.org_tab==org_data.org_tabs_enum.mgt)return v_calendar(calendar.cal_org_mgt,[]),!1}},success:function(e){0==e.ec?v_calendar(t,calendar.set_org_events(e.list_schedule)):cs_msg.noti_err(e.ec)},dataType:"json"})}