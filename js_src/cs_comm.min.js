function set_breadcrumb(e,t){null!=e.parent&&($(t).prepend(`<li class="nodepath">\n<a href="${e.key}" class="bread_node_btn btn btn-sm btn-default over_wrapper" data-node_key="${e.key}">${e.title}</a>\n<span class="bread_tree_list btn btn-default btn-sm" data-node_key="${e.key}">\n<i class="fas fa-caret-down fa-lg"></i>\n</span>\n</li>`),set_breadcrumb(e.parent,t))}function set_org_account_breadcrumb(e,t){org_panel_click(),$(">",t).remove();let a="hidden";0==org_data.is_web&&(a=""),$(t).prepend(`<li class="account_close">\n<span id="org_back_btn" class="btn btn-default btn-md ${a} org_back_btn"><i\nclass="fas fa-lg fa-bars"></i></span>\n</li>`),e.some((function(e){const a=account_list.get_account(e);null!=a&&$(t).append(`<li data-account_seq="${e}" class="account_close account_close_btn">\n<a class="btn btn-default btn-unborder btn-xs" onclick="return false;">\n<img class="img-circle user_photo" src="${a.photo_url}">\n<i class="fas fa-times text-danger"></i>\n</a>\n</li>`)})),t.asBreadcrumbs("destroy"),t.asBreadcrumbs(init.asBreadcrumbs_opt)}function set_account_breadcrumb(e,t,a=!0){$(">",t).remove(),e.some((function(e){const n=account_list.get_account(e);null!=n&&(1==a?($(t).prepend('<li class="account_close"></li>'),$(t).append(`<li data-account_seq="${e}" class="account_close account_close_btn mr_5">\n<a class="btn btn-default btn-unborder btn-xs" onclick="return false;">\n<img class="img-circle user_photo" src="${n.photo_url}">\n<i class="fas fa-times text-danger"></i>\n</a>\n</li>`)):$(t).append(`<li data-account_seq="${e}" class="account_li mr_5">\n<a onclick="return false;">\n${v_user_photo_drop(n,!0)}\n</a>\n</li>`))})),t.asBreadcrumbs("destroy"),t.asBreadcrumbs(init.account_asBreadcrumbs_opt)}function v_user_photo_drop(e,t=!1,a="user_photo"){if(!e)return'<div class="info_tm_7">none</div>';let n="";if(e.account_seq==account_list.get_user_account().account_seq&&(n="disabled"),e.state!=account_list.enum_account_state.normal&&(n="disabled"),1==t)return`<div class="account_drop" data-account_seq="${e.account_seq}">\n<a id="user_img" data-title="${e.name}" data-content="\n<ul class='dropdown-menu'>\n<li id='drop_user_chat' class='dropdown-item ${n}' data-account_seq='${e.account_seq}'>\n<a><i class='far fa-comments'></i><span data-i18n='cs:account.chat'></span></a>\n</li>\n<li class='divider'></li>\n<li id='drop_user_info' class='dropdown-item' data-account_seq='${e.account_seq}'>\n<a><i class='fas fa-info-circle'></i><span data-i18n='cs:account.profile'></span></a>\n</li>\n</ul>">\n<img class="img-circle ${a}" src="${e.photo_url}"></a>\n</div>`;{let t=$(document.createDocumentFragment());return t.append(`<div class="account_drop" data-account_seq="${e.account_seq}">\n<a id="user_img" data-title="${e.name}" data-content="\n<ul class='dropdown-menu'>\n<li id='drop_user_chat' class='dropdown-item ${n}' data-account_seq='${e.account_seq}'>\n<a><i class='far fa-comments'></i><span data-i18n='cs:account.chat'></span></a>\n</li>\n<li class='divider'></li>\n<li id='drop_user_info' class='dropdown-item' data-account_seq='${e.account_seq}'>\n<a><i class='fas fa-info-circle'></i><span data-i18n='cs:account.profile'></span></a>\n</li>\n</ul>">\n<img class="img-circle ${a}" src="${e.photo_url}"></a>\n</div>`),$(".account_drop a",t).webuiPopover("destroy").webuiPopover(init.popover_option),t}}function moment_time(e){let t=moment().startOf("day"),a=moment().startOf("year");return moment().diff(moment.unix(e),"hours")<1?`<span class="moment_i18n" data-format="n" data-time="${e}">${moment.unix(e).fromNow()}</span>`:t.diff(moment.unix(e).startOf("day"),"day")<1?`<span class="moment_i18n" data-format="HH:mm" data-time="${e}">${moment.unix(e).format("HH:mm")}</span>`:a.diff(moment.unix(e).startOf("year"),"year")<1?`<span class="moment_i18n" data-format="MM-DD HH:mm" data-time="${e}">${moment.unix(e).format("MM-DD HH:mm")}</span>`:`<span class="moment_i18n" data-format="MM-DD HH:mm" data-time="${e}">${moment.unix(e).format("YY-MM-DD HH:mm")}</span>`}function lt_time(e){return`<span class="moment_i18n" data-format="LT" data-time="${e}">${moment.unix(e).format("LT")}</span>`}function lts_time(e){return`<span class="moment_i18n" data-format="LTS" data-time="${e}">${moment.unix(e).format("LTS")}</span>`}function lll_time(e){return`<span class="moment_i18n" data-format="lll" data-time="${e}">${moment.unix(e).format("lll")}</span>`}function ll_time(e){return`<span class="moment_i18n" data-format="ll" data-time="${e}">${moment.unix(e).format("ll")}</span>`}function l_time(e){return`<span class="moment_i18n" data-format="l" data-time="${e}">${moment.unix(e).format("l")}`}function schedule_time(e,t,a,n,i){return 0==i?'<div class="dis dis_time btn btn-normal btn-xs" data-i18n="card:info.date.date"></div>':1==a?`<div class="dis dis_time btn btn-normal btn-xs">${ll_time(e)}</div> ~\n<div class="dis dis_time btn btn-danger btn-xs"> ${ll_time(t)}</div>\n<span id="schedule_del_btn" class="dis dis_time btn btn-danger btn-xs"><i class="fas fa-trash"></i></span>`:`<div class="dis dis_time btn btn-normal btn-xs">\n<div>${l_time(e)}</div>\n<div>${lt_time(e)}</div>\n</div>\n~\n<div class="dis dis_time btn btn-danger btn-xs">\n<div>${l_time(t)}</div>\n<div>${lt_time(t)}</div>\n</div>\n<span id="schedule_del_btn" class="dis dis_time btn btn-danger btn-xs"><i class="fas fa-trash"></i></span>`}function select_auth_icon(e,t){return 1==e?'<i class="fas fa-user fa-lg text-success"><p hidden>0</p></i>':t&card_detail.type_auth_enum.owner?`<i class="fas fa-user fa-lg text-danger-o"><p hidden>${t}</p></i>`:t&card_detail.type_auth_enum.viewer?`<i class="fas fa-user fa-lg text-primary-o"><p hidden>${t}</p></i>`:`<i class="fas fa-user fa-lg text-gray"><p hidden>${t}</p></i>`}function select_state_icon(e,t="fa-lg"){let a="",n="";switch(e){case card_detail.type_status_enum.ready:n="far fa-circle",a="text-dark";break;case card_detail.type_status_enum.progress:n="far fa-play-circle",a="text-normal";break;case card_detail.type_status_enum.stop:n="far fa-pause-circle",a="text-warning";break;case card_detail.type_status_enum.cancel:n="far fa-stop-circle",a="text-danger";break;case card_detail.type_status_enum.complete:n="far fa-check-circle",a="text-success";break;case card_detail.type_status_enum.none:n="far fa-play-circle",a="text-grey";break;default:a="text-grey"}return`<i class="${n} ${t} ${a} fa-fw"><p hidden>${e}</p></i>`}function select_state_sytle(e,t){let a='<span class="label label-primary" data-i18n="card:card.normal"></span>';return e&&(a='<span class="label label-grey" data-i18n="card:card.hidden"></span>'),t&&(a='<span class="label label-danger" data-i18n="card:card.deleted"></span>'),a}function select_title_sytle(e,t,a,n){let i="";return e&&(i="text-hidden"),t&&(i="text-deleted"),`<div id="view_contents_btn" style="text-align: left" class="over_wrapper"  data-card_seq="${n}">\n<span class="${i} title_style" data-card_seq="${n}"> ${a}</span>\n</div>`}function select_priority_icon(e,t="fa-lg"){let a=null,n=null;switch(e){case card_detail.type_priority_enum.urgent:a="fa-angle-double-up",n="text-danger";break;case card_detail.type_priority_enum.high:a="fa-angle-up",n="text-warning";break;case card_detail.type_priority_enum.medium:a="fa-minus",n="text-primary";break;case card_detail.type_priority_enum.low:a="fa-angle-down",n="text-dark";break;case card_detail.type_priority_enum.lowest:a="fa-angle-double-down",n="text-light";break;default:a="fa-minus",n="text-primary"}return`<i class="fas ${a} ${n} ${t}"></i>`}function select_schedule_icon(e){return 1==e?`<i class="far fa-clock text-danger fa-lg"><p class="hidden">${e}</p></i>`:`<i class="far fa-clock text-dark-gray fa-lg"><p class="hidden">${e}</p></i>`}function select_lock_icon(e){return 1==e?`<i class="fas fa-lock text-gold fa-lg"><p class="hidden">${e}</p></i>`:`<i class="fas fa-unlock text-dark-gray fa-lg"><p class="hidden">${e}</p></i>`}function select_new_icon(e){return 1==e?"":'<span class="label item_new">NEW</span>'}function account_set_profile_space(e,t){$.ajax({url:"/account_set_profile_space",method:"POST",data:{space_seq:space_seq,name:e,intro:t},success:function(a){0==a.ec?(account_list.account.intro=t,account_list.account.name=e,$("#profile_edit_modal").modal("hide")):cs_msg.noti_err(a.ec)},dataType:"json"})}$(document).on("click","#card_detail .breadcrumb .bread_node_btn",(function(e){e.preventDefault(),e.stopPropagation();let t=$("#tree").fancytree("getTree").getNodeByKey($(this).data("node_key").toString());null!=t?list_node_click(t,!0):cs_msg.noti_err()})),$(document).on("click","#card_detail .breadcrumb .bread_tree_list",(function(e){e.stopPropagation();let t=$("#tree").fancytree("getTree").getNodeByKey($(this).data("node_key").toString());$(this).webuiPopover("destroy").webuiPopover({trigger:"click",width:200,cache:!1,arrow:!1,padding:!1,content:`<ul class="tree_breadcrumb_dropdown_ul list-group">${get_nodes_title(t.getChildren())}</ul>`,onShow:function(e){$(".webui-popover-content",e).css("max-height","300px"),e.localize()}}),$(this).webuiPopover("show")})),$(document).on("click","#note_detail .breadcrumb .bread_node_btn",(function(e){e.preventDefault(),e.stopPropagation();let t=$("#note_tree").fancytree("getTree").getNodeByKey($(this).data("node_key").toString());null!=t?note_node_click(t,!0):cs_msg.noti_err()})),$(document).on("click","#note_detail .breadcrumb .bread_tree_list",(function(e){e.stopPropagation();let t=$("#note_tree").fancytree("getTree").getNodeByKey($(this).data("node_key").toString());$(this).webuiPopover("destroy").webuiPopover({trigger:"click",width:200,cache:!1,arrow:!1,padding:!1,content:`<ul class="tree_breadcrumb_dropdown_ul list-group">${get_nodes_title(t.getChildren())}</ul>`,onShow:function(e){$(".webui-popover-content",e).css("max-height","300px"),e.localize()}}),$(this).webuiPopover("show")})),$(document).on("click",".tree_breadcrumb_dropdown_ul li",(function(){switch($(this).data("tree_type")){case tree_data.enum_tree_type.card:{let e=$("#tree").fancytree("getTree").getNodeByKey($(this).data("node_seq").toString());if(null==e)return void cs_msg.noti_err();list_node_click(e,!0);break}case tree_data.enum_tree_type.note:{let e=$("#note_tree").fancytree("getTree").getNodeByKey($(this).data("node_seq").toString());if(null==e)return void cs_msg.noti_err();note_node_click(e,!0);break}}})),$(document).on("click touchend","#drop_user_chat:not(.disabled)",(function(e){e.preventDefault(),e.stopPropagation(),WebuiPopovers.hideAll(),set_room_create([$(this).data("account_seq")],org_room_create,!1)})),$(document).on("click touchend",".webui-popover #drop_user_info",(function(e){e.preventDefault(),e.stopPropagation(),WebuiPopovers.hideAll(),account_get_profile_space($(this).data("account_seq"),account_profile,!1)})),setInterval((function(){let e=$(".moment_time"),t=e.length;for(let a=0;a<t;++a)$(">",e[a]).remove(),$(e[a]).append(moment_time($(e[a]).data("ctime")))}),6e4);let user_profile=function(e){account_list.set_user_account(e.profile),$("#user_drop >").remove(),$("#chat_contents #user_img").remove(),$("#user_drop").append(`<img class="img-circle user_photo" src="${account_list.account.photo_url}">\n<span class="toggle_hide">${e.profile.name}\n</span>`),$("#chat_contents #send_msg").prepend(`<div id="user_img" class="media-left">\n<img class="pull-left img-circle user_photo" src="${account_list.account.photo_url}">\n</div>`),0==account_list.account.is_admin?($("#space_setting_btn").addClass("hidden"),$("#space_setting_btn_hr").addClass("hidden"),1==$("#space_setting_modal").hasClass("in")&&swal.fire("관리자 권한이 변경되었습니다.").then((e=>{$("#space_setting_modal").modal("hide")}))):($("#space_setting_btn").removeClass("hidden"),$("#space_setting_btn_hr").removeClass("hidden"))},account_profile=function(e){$("#account_info_modal .modal-body >").remove(),$("#account_info_modal .modal-body").append(`<div class="photo_md"><img src="${e.profile.photo_url}" class="img-circle user_photo"></div>\n<h3>${e.profile.name}</h3>\n<div class="ql-editor"><p><b data-i18n="cs:account.intro"></b></p>${e.profile.intro}</div>`),$("#account_info_modal").modal()},v_org_member_profile=function(e){$("#org_member_detail >").remove();let t="hidden";0==org_data.is_web&&(t=""),$("#org_member_detail").append(`<span id="org_back_btn" class="btn btn-default btn-md ${t}"><i\nclass="fas fa-lg fa-bars"></i></span>\n<div class="photo_md"><img src="${e.profile.photo_url}" class="img-circle user_photo"></div>\n<h3>${e.profile.name}</h3>\n<div class="ql-editor"><p><b data-i18n="cs:account.intro"></b></p>${e.profile.intro}</div>\n<div id="drop_user_chat" class="btn btn-default" data-account_seq="${e.profile.account_seq}">채팅</div>\n<div class="btn btn-default">메시지</div>\n`)};function account_get_profile_space(e,t=user_profile,a=!0){$.ajax({url:"/account_get_profile_space",method:"POST",async:a,data:{space_seq:space_seq,account_seq:e},success:function(e){0==e.ec?t(e):cs_msg.noti_err(e.ec)},dataType:"json"})}function v_file_preview(e,t,a,n,i,s,o="li",c=init.enum_preview_size.w100){return 1==e?`<${o} class="lcl_item inline ${c==init.enum_preview_size.w100?"v_110":""}"\ndata-index="${s}"\ndata-file_seq="${t}"\ndata-file_name="${n}"\ndata-file_mimetype="${a}"\ndata-file_size="${i}"\ndata-file_is_preview="${e}">\n<div id="lcl_open_btn">\n<img src="/file_preview/${space_seq}/${t}/${c}">\n</div>\n<div id="file_down_btn" class="center_flex over_wrapper"\ndata-file_seq="${t}">\n<span class="over_wrapper">${n.split(".")[0]}</span>\n<span>.${n.split(".")[1]}</span>\n</div>\n<div class="over_wrapper text-center">${humanize_file_size(t)}</div>\n</${o}>`:`<${o} class="inline v_110 text-center">\n<i class="far fa-file fa-5x pb_8"></i>\n<div id="file_down_btn" class="center_flex over_wrapper"\ndata-file_seq="${t}">\n<span class="over_wrapper">${n.split(".")[0]}</span>\n<span>.${n.split(".")[1]}</span>\n</div>\n<div class="over_wrapper text-center">${humanize_file_size(t)}</div>\n</${o}>`}function get_web_link(e,t,a,n=window.location.href){let i=$("<input>");$(e).append(i),i.val(n).select(),document.execCommand("copy"),i.remove(),new Noty({theme:"sunset",text:`<div>${t.title}</div>\n<div class="noty_update" data-i18n="noti:${a} link copy"></div>`,type:"info",layout:"topCenter",timeout:2e3,callbacks:{afterShow:function(){$(".noty_update").localize()}}}).show()}function v_card_item(e,t){t.forEach((function(t){$(e).append(`<div class="list-group-item padding_5" data-card_seq="${t.key}">\n<span class="pull-left">\n${select_state_icon(t.data.status)}\n</span>\n<span id="v_card_remove_btn" class="pull-right cursor_pointer remove_btn">\n<i class="fas fa-times fa-2x text-danger"></i>\n</span>\n${select_title_sytle(t.data.is_hidden,t.data.is_deleted,t.title,t.key)}\n<div id="status_icons">\n<div>\n<span>\n${select_state_sytle(t.data.is_hidden,t.data.is_deleted)}\n</span>\n<span id="priority">\n${select_priority_icon(t.data.priority,"fa-lg")}\n</span>\n<span id="per_done">${t.data.per_done}%</span>\n</div>\n</div>`)}))}$(document).on("click","#tabs-tree #card_seq_copy",(function(){get_web_link($(this),card_detail.card_node,"card")})),$(document).on("click","#todo_split_right #card_seq_copy",(function(){let e=$(this).data("card_seq").toString(),t=$("#tree").fancytree("getTree").getNodeByKey(e),a={data:[init.main_tabs_enum.tree,e,null]},n=window.location.origin+window.location.pathname+"?q="+encodeURIComponent(btoa(JSON.stringify(a)));get_web_link($(this),t,"card",n)})),$(document).on("click","#card_view_modal #card_seq_copy",(function(){let e=$(this).data("card_seq").toString(),t=$("#tree").fancytree("getTree").getNodeByKey(e),a={data:[init.main_tabs_enum.tree,e,null]},n=window.location.origin+window.location.pathname+"?q="+encodeURIComponent(btoa(JSON.stringify(a)));get_web_link($(this),t,"card",n)})),$(document).on("click","#lcl_table_open_btn",(function(){let e;switch($(this).closest(".lcl_list").data("type")){case tree_data.enum_tree_type.card:e=file_list_table;break;case tree_data.enum_tree_type.note:e=note.note_file_list_table;break;default:e=file_list_table}let t,a=e.rows().data(),n=a.length,i=e.row($(this).closest("tr")).data()[7],s=new Array,o=0;for(let e=0;e<n;++e,++o){if(0==a[e][11]){--o;continue}a[e][7]==i&&(t=o);let n={type:"image",src:`/file_preview/${space_seq}/${a[e][7]}/4`,title:a[e][8],txt:a[e][9],author:humanize_file_size(a[e][10]),thumb:`/file_preview/${space_seq}/${a[e][7]}/3`,download:`/file_down/${space_seq}/${a[e][7]}/1`,canonical_url:`/file_down/${space_seq}/${a[e][7]}/2`};s.push(n)}let c=lc_lightbox(s,{open_close_time:0,txt_hidden:!0,download:!0,cmd_position:"outer",nav_btn_pos:"middle"});lcl_open(c,t)})),$(document).on("click","#lcl_open_btn",(function(){let e=new Array,t=$(".lcl_item",$(this).closest(".lcl_list")),a=t.length;for(let n=0;n<a;++n){if(0==t[n].is_preview)continue;let a={type:"image",src:`/file_preview/${space_seq}/${$(t[n]).data("file_seq")}/4`,title:$(t[n]).data("file_name"),txt:$(t[n]).data("file_mimetype"),author:humanize_file_size($(t[n]).data("file_size")),thumb:`/file_preview/${space_seq}/${$(t[n]).data("file_seq")}/3`,download:`/file_down/${space_seq}/${$(t[n]).data("file_seq")}/1`,canonical_url:`/file_down/${space_seq}/${$(t[n]).data("file_seq")}/2`};e.push(a)}let n=lc_lightbox(e,{open_close_time:0,txt_hidden:!0,download:!0,cmd_position:"outer",nav_btn_pos:"middle"});console.log($(this).closest(".lcl_item")),lcl_open(n,$(this).closest(".lcl_item").data("index"))})),$(document).on("click","#submenu_btn",(function(e){e.stopPropagation(),e.preventDefault(),$(".dropdown-submenu ul",$(this).closest(".dropdown")).hide(),$(this).next("ul").toggle()})),$(document).on("show.bs.dropdown",".dropdown",(function(e){$(".dropdown-submenu ul",this).hide()})),$(document).on("show.bs.modal",".modal",(function(){let e=0;$(".modal.in").each((function(t,a){e=e<$(a).css("z-index")?$(a).css("z-index"):e})),$(".jsPanel:not(.hidden)").each((function(t,a){e=e<$(a).css("z-index")?$(a).css("z-index"):e})),0!=e&&$(this).css("z-index",++e),$(".modal").hasClass("in")?($(this).addClass("sub_modal"),$(this).removeClass("fade")):($(this).removeClass("sub_modal"),$(this).addClass("fade"))})),$(document).on("keyup",".search_input",(function(){let e=$(this).parent();0==$(this).val().length?(e.find(".clear_btn").addClass("hidden"),e.find("input").val(""),e.find(".search_btn").trigger("click")):e.find(".clear_btn").removeClass("hidden")})),$(document).on("click",".clear_btn",(function(){$(this).addClass("hidden");let e=$(this).parent();e.find("input").val(""),e.find(".search_btn").trigger("click")})),$(document).on("click",".popover_close",(function(){WebuiPopovers.hideAll()})),$(document).on("click","#go_spaces_list",(function(){window.location.href="/spaces"})),$(document).on("click","#logout",(function(){window.location.href="/logout"})),$(document).on("click touchstart touchmove",".webui-popover-backdrop",(function(e){e.preventDefault(),e.stopPropagation(),WebuiPopovers.hideAll()}));