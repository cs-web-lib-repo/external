Dropzone.autoDiscover=!1;let template='<div class="list-group-item">\n<div class="start_flex">\n<div class="preview flex_none">\n<img data-dz-thumbnail class="src_none"/><i class="file_icon far fa-file fa-5x fa-fw text-center flex_none"></i>\n</div>\n<div class="overflow_hidden flex_item_default">\n<div class="between_flex">\n<p class="name over_wrapper padding_5" data-dz-name></p>\n<div class="start_flex">\n<p class="size over_wrapper padding_5" data-dz-size></p>\n<div id="dz_remove_btn" class="padding_5" data-dz-remove><i class="fas fa-times fa-2x text-danger"></i></div>\n</div>\n</div>\n<div class="progress active margin_5" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">\n<div id="file_upload_progress" class="progress-bar progress-bar-navy-light" style="width:0%;" data-dz-uploadprogress></div>\n</div>\n<strong class="error text-danger" data-dz-errormessage></strong>\n</div>\n</div>\n</div>',dropzone_op={url:"/index.php/set_prepare_create",previewTemplate:template,thumbnailWidth:60,thumbnailHeight:60,maxFilesize:null,parallelUploads:5,timeout:0,dictRemoveFile:null,isDragging:!1,dragenter:function(e){e.preventDefault(),e.stopPropagation(),this.isDragging||(this.isDragging=!0,$(this.element).addClass("dz-drag-hover"))},dragover:function(e){e.preventDefault(),e.stopPropagation(),this.isDragging||(this.isDragging=!0,$(this.element).addClass("dz-drag-hover"))},dragleave:function(e){e.preventDefault(),e.stopPropagation(),e.target==this.element&&this.isDragging&&(this.isDragging=!1,$(this.element).removeClass("dz-drag-hover"))}};function file_panel_controller(e){1==init.is_web?(e.resize({width:"40%",height:"30%"}),e.reposition({my:"right-bottom",at:"right-bottom",offsetX:-10,offsetY:-10})):(e.resize({width:"100%",height:"30%"}),e.reposition({my:"right-bottom",at:"right-bottom"}))}function get_files_info(){let e=$("#file_per_previews .dropzone>div").length,t=$("#file_per_previews .dropzone .dz-complete").length,n=e-t;$("#file_per_previews .dropzone .dz-error").length;0==n?init.file_per_panel.setHeaderTitle(`<b id="file_up_info">파일 업로드 ${e}개 완료</b>`):init.file_per_panel.setHeaderTitle(`<div id="file_up_info" class="progress active" role="progressbar" aria-valuemin="0" aria-valuemax="${e}" aria-valuenow="0">\n<div class="progress-bar progress-bar-navy-light" style="width:${t/e*100}%;">\n파일 업로드 ${t} / ${e} 완료\n</div>\n</div>`)}function file_dropzone(e,t){let n={...dropzone_op};$(".dz-hidden-input").remove(),n.clickable="#"+$(e).parents(".dropzone_tag")[0].id+" #"+$(e)[0].id+" #file_create_btn",n.article_seq=t,n.previewsContainer="#file_per_previews .dropzone",n.init=function(){let e=this;$("#upload_clear_btn").click((function(){e.removeAllFiles(),get_files_info()})),this.on("dragenter",(function(t){return $(e.element).hasClass("dz-drag-lock")?e.element.classList.remove("dz-drag-hover"):e.element.classList.add("dz-drag-hover")})),this.on("dragover",(function(t){return $(e.element).hasClass("dz-drag-lock")?e.element.classList.remove("dz-drag-hover"):e.element.classList.add("dz-drag-hover")})),this.on("drop",(function(){contents_data.target_front_seq=contents_data.front_seq_enum.last_seq})),this.on("addedfile",(function(e){get_files_info(),$("#file_per_previews").removeClass("hidden")})),this.on("removefile",(function(e){get_files_info()})),this.on("thumbnail",(function(e){$(".preview > i",e.previewElement).remove()})),this.on("error",(function(e,t){get_files_info();let n=$("#file_upload_progress",e.previewElement);n.removeClass("progress-bar-navy-light"),n.addClass("progress-bar-danger"),n.text("")})),this.on("sending",(function(t,n,i){i.append("_token",$('meta[name="csrf-token"]').attr("content")),i.append("space_seq",space_seq),i.append("article_seq",e.options.article_seq),i.append("front_seq",null==contents_data.target_front_seq?contents_data.front_seq_enum.front_seq:contents_data.target_front_seq),i.append("file_name",t.name),i.append("file_size",t.size),i.append("file_mimetype",t.type)})),this.on("success",(function(t,n,i){get_files_info();let s=JSON.parse(n);$(t.previewElement).data("file_seq",s.file_seq),0==s.ec?timeline_set_article_section_create_file(e,t,s.file_seq,s.article_seq,s.front_seq):(cs_msg.noti_err(s.ec),e.emit("error",t,i18next.t(cs_msg.select_err_key(s.ec))))})),this.on("queuecomplete",(function(){get_files_info(),timeline_get_article(e.element,e.options.article_seq)})),this.on("uploadprogress",(function(e,t,n){$(".progress-bar",e.previewElement).text(Math.floor(t)+"%")}))},$(e).dropzone(n)}function article_file_dropzone(e,t,n){let i={...dropzone_op};i.previewsContainer=t,i.clickable=n,i.init=function(){let e=this;this.on("thumbnail",(function(e){$(".preview > i",e.previewElement).remove()})),this.on("error",(function(e,t){let n=$("#file_upload_progress",e.previewElement);n.removeClass("progress-bar-navy-light"),n.addClass("progress-bar-danger"),n.text("")})),this.on("sending",(function(t,n,i){i.append("_token",$('meta[name="csrf-token"]').attr("content")),i.append("space_seq",space_seq),i.append("article_seq",e.options.article_seq),i.append("file_name",t.name),i.append("file_size",t.size),i.append("file_mimetype",t.type)})),this.on("success",(function(t,n,i){let s=JSON.parse(n);0==s.ec?$(t.previewElement).data("file_seq",s.file_seq):(cs_msg.noti_err(s.ec),e.emit("error",t,i18next.t(cs_msg.select_err_key(s.ec))))})),this.on("uploadprogress",(function(e,t,n){$(".progress-bar",e.previewElement).text(Math.floor(t)+"%")}))},$(e).dropzone(i)}function confirm_file_dropzone(e,t){let n={...dropzone_op};n.previewsContainer="#confirm_create_modal #confirm_file_zone",n.clickable="#confirm_create_modal #confirm_file_add_btn",n.article_seq=t,n.init=function(){let e=this;this.on("thumbnail",(function(e){$(".preview > i",e.previewElement).remove()})),this.on("error",(function(e,t){let n=$("#file_upload_progress",e.previewElement);n.removeClass("progress-bar-navy-light"),n.addClass("progress-bar-danger"),n.text("")})),this.on("sending",(function(t,n,i){i.append("_token",$('meta[name="csrf-token"]').attr("content")),i.append("space_seq",space_seq),i.append("article_seq",e.options.article_seq),i.append("front_seq",null==contents_data.target_front_seq?contents_data.front_seq_enum.front_seq:contents_data.target_front_seq),i.append("file_name",t.name),i.append("file_size",t.size),i.append("file_mimetype",t.type)})),this.on("success",(function(t,n,i){let s=JSON.parse(n);0==s.ec?$(t.previewElement).data("file_seq",s.file_seq):(cs_msg.noti_err(s.ec),e.emit("error",t,i18next.t(cs_msg.select_err_key(s.ec))))})),this.on("uploadprogress",(function(e,t,n){$(".progress-bar",e.previewElement).text(Math.floor(t)+"%")}))},$(e).dropzone(n)}function event_file_dropzone(e,t,n){let i={...dropzone_op};i.previewsContainer=n,i.clickable=t,i.init=function(){let e=this;this.on("thumbnail",(function(e){$(".preview > i",e.previewElement).remove()})),this.on("error",(function(e,t){let n=$("#file_upload_progress",e.previewElement);n.removeClass("progress-bar-navy-light"),n.addClass("progress-bar-danger"),n.text("")})),this.on("sending",(function(t,n,i){i.append("_token",$('meta[name="csrf-token"]').attr("content")),i.append("space_seq",space_seq),i.append("article_seq",e.options.article_seq),i.append("front_seq",null==contents_data.target_front_seq?contents_data.front_seq_enum.front_seq:contents_data.target_front_seq),i.append("file_name",t.name),i.append("file_size",t.size),i.append("file_mimetype",t.type)})),this.on("success",(function(t,n,i){let s=JSON.parse(n);0==s.ec?$(t.previewElement).data("file_seq",s.file_seq):(cs_msg.noti_err(s.ec),e.emit("error",t,i18next.t(cs_msg.select_err_key(s.ec))))})),this.on("uploadprogress",(function(e,t,n){$(".progress-bar",e.previewElement).text(Math.floor(t)+"%")}))},$(e).dropzone(i)}function chat_file_dropzone(e){let t={...dropzone_op};t.clickable="#chat #chat_file_add_btn",t.init=function(){let e=this;this.group_seq=0,this.on("thumbnail",(function(e){$(".preview > i",e.previewElement).remove()})),this.on("error",(function(e,t){let n=$("#file_upload_progress",e.previewElement);n.removeClass("progress-bar-navy-light"),n.addClass("progress-bar-danger"),n.text("")})),this.on("drop",(function(){++this.group_seq})),this.on("addedfile",(function(t){t.room_seq=chat_data.room_seq,t.group_seq=this.group_seq,$(e.element).scrollTop($(e.element).prop("scrollHeight"))})),this.on("sending",(function(e,t,n){n.append("_token",$('meta[name="csrf-token"]').attr("content")),n.append("space_seq",space_seq),n.append("article_seq",e.room_seq),n.append("file_name",e.name),n.append("file_size",e.size),n.append("file_mimetype",e.type)})),this.on("success",(function(t,n){let i=JSON.parse(n);0==i.ec?t.file_seq=i.file_seq:(cs_msg.noti_err(i.ec),e.emit("error",t,i18next.t(cs_msg.select_err_key(i.ec))))})),this.on("queuecomplete",(function(){let t=new Object;e.files.forEach((function(n){n.group_seq in t||(t[n.group_seq]={room_seq:n.room_seq,file_seqs:new Array}),t[n.group_seq].file_seqs.push(n.file_seq),e.removeFile(n)}));for(const e in t)set_msg("",t[e].room_seq,t[e].file_seqs)})),this.on("uploadprogress",(function(e,t,n){$(".progress-bar",e.previewElement).text(Math.floor(t)+"%")}))},$(e).dropzone(t)}$(document).on("paste","#tabs-card-info #card_contents #contents_area",(async e=>{if(navigator.clipboard)try{const e=await navigator.clipboard.read();for(const t of e)for(const e of t.types){const n=await t.getType(e);contents_data.clipdata=n,-1!=contents_data.clipdata.type.indexOf("image")&&(contents_data.clipdata.name=moment().format("YYYY_MM_DD__HH_mm_ss")+".jpg",Dropzone.forElement($("#tabs-card-info #card_contents #contents_area")[0]).addFile(contents_data.clipdata))}}catch(e){}}));